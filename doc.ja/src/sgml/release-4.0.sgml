<!-- doc/src/sgml/release-4.0.sgml -->
<!-- See header comment in release.sgml about typical markup -->

<sect1 id="release-4-0-21">
 <title>リリース 4.0.21</title>
  <note>
   <title>リリース日</title>
   <simpara>2022-12-22</simpara>
  </note>

 <sect2>
  <title>変更点</title>
  <itemizedlist>

   <listitem>
    <!--
    2022-12-03 [bcea238]
    -->
    <para>
     ログメッセージ"new IPC connection received"をDEBUG1にダウングレードしました。
     (<ulink url="https://www.pgpool.net/mantisbt/view.php?id=775">bug 775</ulink>) (Bo Peng)
    </para>
    <para>
     これは通常のメッセージで、LOGとして記録されるべきではありません。
     パッチはpstefによって作成され、Bo Pengによってレビューされました。
    </para>
   </listitem>

  </itemizedlist>
 </sect2>

 <sect2>
  <title>不具合修正</title>
  <itemizedlist>

   <listitem>
    <!--
    2022-12-20 [7bc3176]
    -->
    <para>
     <xref linkend="guc-failover-require-consensus">の問題を修正しました。(Muhammad Usama)
    </para>
    <para>
     Watchdogクラスタ全体のヘルスチェックパラメータの最大値に基づいて、フェイルオーバコマンドのタイムアウトを動的に設定するように修正しました。
    </para>
    <para>
     Tatsuo Ishiiによってレビューおよびテストされました。
     議論: <ulink url="https://www.pgpool.net/pipermail/pgpool-hackers/2022-November/004228.html">[pgpool-hackers: 4227]</ulink>
    </para>
   </listitem>

   <listitem>
    <!--
    2022-11-24 [77fdaca]
    -->
    <para>
     パーサ内でバックスラッシュを使った場合の警告を出力しないように修正しました。(Tatsuo Ishii)
    </para>
    <para>
     <varname>standard_conforming_strings = off</varname>かつ<varname>escape_string_warning = on</varname>の場合、<productname>PostgreSQL</productname>は文字列リテラル内でバックスラッシュを使った場合に警告を出力します。
     これは問題ありません。
     しかし、以前は<productname>Pgpool-II</productname>のパーサも同じメッセージを出力していました。
     これは冗長です。
    </para>
   </listitem>

   <listitem>
    <!--
    2022-10-27 [573b84b]
    -->
    <para>
     <varname>idle_session_timeout</varname>に対応しました。(Tatsuo Ishii)
    </para>
    <para>
     idle_session_timeout (PostgreSQL 14 で追加)が有効、かつ、タイムアウトが発生した場合、次のことが発生します:
     <itemizedlist>
      <listitem>
       <para>
        <varname>failover_on_backend_error</varname>がon (デフォルト)の場合、<productname>Pgpool-II</productname>はフェイルオーバを発生させます。
       </para>
      </listitem>
     </itemizedlist>
     <itemizedlist>
      <listitem>
       <para>
        PostgreSQL サーバが 1 台のみが idle_session_timeout を有効にしていると、Pgpool-II がハングする可能性があります。
       </para>
      </listitem>
     </itemizedlist>
    </para>
    <para>
     idle_session_timeoutに対応するため、エラーコードを検出するdetect_idle_session_timeout_error()を追加しました。
     エラーを検出すると、Pgpool-II は致命的なエラーとしてフロントエンドにエラーコードを返し、セッションを切断します。
     これはidle_in_transaction_session_timeoutの実装と同じような修正です。
     <ulink url="https://git.postgresql.org/gitweb/?p=pgpool2.git;a=commit;h=3f5986eee360f12e6a0bb77aa46f95abf5f6bc10">3f5986eee360f12e6a0bb77aa46f95abf5f6bc10</ulink>
    </para>
    <para>
     議論: <ulink url="https://www.pgpool.net/pipermail/pgpool-hackers/2022-October/004209.html">[pgpool-hackers: 4208]</ulink>
    </para>
   </listitem>

   <listitem>
    <!--
    2022-09-14 [963391b]
    -->
    <para>
     SSLエラーSSL_ERROR_ZERO_RETURNに対応しました。(Tatsuo Ishii)
    </para>
    <para>
     以前はこれによってフェイルオーバが発生しましたが、サーバは単に接続を閉じることを意味するため、実際には不要でした。
    </para>
    <para>
     議論: <ulink url="https://www.pgpool.net/pipermail/pgpool-general/2022-September/008425.html">[pgpool-general: 8366]</ulink>
     議論: <ulink url="https://www.pgpool.net/pipermail/pgpool-hackers/2022-September/004194.html">[pgpool-hackers: 4193]</ulink>
    </para>
   </listitem>

   <listitem>
    <!--
    2022-10-01 [c360057]
    -->
    <para>
     メモリキャッシュサイズを2GBより多く設定した場合に発生するセグメンテーション違反を修正しました。(Muhammad Usama)
    </para>
    <para>
     問題は与えられたキャッシュブロックのメモリアドレスを返す block_address()関数にあり、
     2GB上限まで有効な共有メモリ空間内のブロックのオフセットを計算するために32bit整数を使っていました。
    </para>
   </listitem>

   <listitem>
    <!--
    2022-09-23 [50f0285]
    -->
    <para>
     <command>pcp_proc_info</command>、<command>SHOW pool_pools</command>および<command>SHOW pool_processes</command>内のまれなセグメンテーション違反を修正しました。(Tatsuo Ishii)
    </para>
    <para>
     セグメンテーション違反はget_pools()とget_processes()にありました。
     それらは、最初に共有メモリ上の特定のプロセス情報スロットのpidを抽出し、次にキーとして pid を使ってスロットを再び検索していました。
     これらのステップはロックによって保護されていなかったため、プロセス終了時に新しい子プロセスのフォークを担う親プロセスによって pid が上書きされた場合、
     pid を使った検索が失敗し、NULLを返す可能性がありました。
     その結果、それに続くNULLポインタの参照によってセグメンテーション違反が発生していました。
    </para>
    <para>
     解決策は、最初にプロセス情報スロットへのポインタを取得し、次にポインタからpidメンバを抽出することです。
     この方法でも、親プロセスによる共有メモリ情報の同時更新は可能ですが(出力におかしな結果をもたらす可能性があります)、少なくともセグメンテーション違反は回避できます。
    </para>
   </listitem>

   <listitem>
    <!--
    2022-09-12 [7b288c6]
    -->
    <para>
     無効な長さのUnixドメインソケットパスを使えないように修正しました。(Masaya Kawamoto)
    </para>
   </listitem>

  </itemizedlist>
 </sect2>

 <sect2>
  <title>ドキュメント修正</title>
  <itemizedlist>

   <listitem>
    <!--
    2022-10-07 [0acb52b]
    -->
    <para>
     Doc: memqcache_methodの説明を拡充しました。(Tatsuo Ishii)
    </para>
    <para>
     どの方式を使うべきかの説明を追加しました。
    </para>
   </listitem>

   <listitem>
    <!--
    2022-08-28 [4551ef6]
    -->
    <para>
     Doc: ヘルスチェックプロセスでSSLが使えることに言及しました。(Tatsuo Ishii)
    </para>
    <para>
     ストリーミングレプリケーションのチェックでもSSLが使えることに言及しました。
     これは2010年以降に使えていたはずです。
    </para>
    <para>
     議論: <ulink url="https://www.pgpool.net/pipermail/pgpool-hackers/2022-August/004188.html">[pgpool-hackers: 4187]</ulink>
    </para>
   </listitem>

  </itemizedlist>
 </sect2>

 <sect2>
  <title>回帰テスト修正</title>
  <itemizedlist>

   <listitem>
    <!--
    2022-12-17 [2985853]
    -->
    <para>
     環境変数を使ってPGPOOLDIRを定義できるようにしました。
     (<ulink url="https://www.pgpool.net/mantisbt/view.php?id=766">bug 766</ulink>) (Bo Peng)
    </para>
   </listitem>

  </itemizedlist>
 </sect2>
</sect1>

<sect1 id="release-4-0-20">
 <title>リリース 4.0.20</title>
  <note>
   <title>リリース日</title>
   <simpara>2022-08-18</simpara>
  </note>

 <sect2>
  <title>不具合修正</title>
  <itemizedlist>

   <listitem>
    <!--
    2022-07-05 [f6fa086f]
    2022-07-04 [46961809]
    -->
    <para>
     クエリキャッシュの不具合を修正しました。(Tatsuo Ishii)
    </para>
    <para>
     <!--
     Pgpool-II did not cache the query like "Select '2022-02-18 07:00:00.006547'::timestamp".
     SELECTs include TIMESTAMP, TIME and DATE are cached, and SELECTs include TIMESTAMPZ
     and TIMEZ are not cached because the result can be changed by SET TIME ZONE command etc.
     Furthermore, SELECTs having functions with return types are timestamptz or timetz are
     not cached too as same reason.
     Discussion: <ulink url="https://www.pgpool.net/pipermail/pgpool-general/2022-July/008344.html">[pgpool-general: 8285]</ulink>
     -->
     Pgpool-IIは"Select '2022-02-18 07:00:00.006547'::timestamp"のような問合せをキャッシュしていませんでした。
     TIMESTAMP、TIME、DATEを含むSELECT文はキャッシュされるようになりますが、TIMESTAMPZ、TIMEZを含むSELECT文は"SET TIME ZONE"コマンドなどで結果が変更されるためキャッシュされません。
     また、TIMESTAMPZやTIMEZ型を返す関数を含むSELECT文も同様の理由でキャッシュされません。
     Discussion: <ulink url="https://www.pgpool.net/pipermail/pgpool-general/2022-July/008344.html">[pgpool-general: 8285]</ulink>
    </para>
   </listitem>

  </itemizedlist>
 </sect2>

 <sect2>
  <title>ドキュメント修正</title>
  <itemizedlist>

   <listitem>
    <!--
    2022-07-19 [668fcea2]
    -->
    <para>
     Doc: 特定のSELECT文がキャッシュされないことに言及しました。(Tatsuo Ishii)
    </para>
    <para>
     特定のSELECT文は以下です。
     <itemizedlist>
      <listitem>
       <para>
        TIMESTAMP WITH TIMEZONE、TIME WITH TIMEZONEを返す関数を使っているSELECT
       </para>
      </listitem>
      <listitem>
       <para>
        TIMESTAMP WITH TIMEZONE、TIME WITH TIMEZONEへのキャストを含むSELECT
       </para>
      </listitem>
      <listitem>
       <para>
        SQLValueFunction (CURRENT_TIME, CURRENT_USERなど)を含むSELECT
       </para>
      </listitem>
     </itemizedlist>
    </para>
   </listitem>

   <listitem>
    <!--
    2022-06-30 [9af40d9f]
    -->
    <para>
     Doc: Unixドメインソケット接続するときのPCPパスワードファイルの使用についての説明を修正しました。(Masaya Kawamoto)
    </para>
    <para>
     pcppassファイルのlocalhostエントリはデフォルトのPCPソケットディレクトリパスへの接続とのみマッチして、全てのUnixソケット接続には使用されません。
     この振る舞いはpgpassファイルと同じです。
    </para>
   </listitem>

   <listitem>
    <!--
    2022-06-02 [321265a9]
    -->
    <para>
     Doc: <xref linkend="guc-memqcache-maxcache">と<xref linkend="guc-memqcacheexpire">の誤った説明を修正しました。(Tatsuo Ishii)
    </para>
    <para>
     これらのパラメータは設定ファイルの再読み込みでは変更できず、Pgpool-IIの再起動が必要です。

     Discussion: <ulink url="https://www.pgpool.net/pipermail/pgpool-general/2022-June/008254.html">[pgpool-general: 8195]</ulink>
    </para>
   </listitem>

  </itemizedlist>
 </sect2>

 <sect2>
  <title>テストツール修正</title>
  <itemizedlist>

   <listitem>
    <!--
    2022-06-26 [ac315b9d]
    -->
    <para>
     PostgreSQL 15でpgpool_setupを実行できるようになりました。(Tatsuo Ishii)
    </para>
    <para>
     <ulink url="https://www.pgpool.net/mantisbt/view.php?id=757">ticket 757</ulink>を参照ください。
    </para>
   </listitem>

  </itemizedlist>
 </sect2>

 <sect2>
  <title>回帰テスト修正</title>
  <itemizedlist>

   <listitem>
    <!--
    2022-07-10 [27eefe98]
    -->
    <para>
     Test: 回帰テストで<productname>Pgpool-II</productname>のバージョンを表示するようになりました。(Tatsuo Ishii)
    </para>
   </listitem>

   <listitem>
    <!--
    2022-07-09 [d8c7c40f]
    -->
    <para>
     Test: 適切なinstall directoryでpgpool.confを探すように回帰テストスクリプトを修正しました。(Tatsuo Ishii)
    </para>
   </listitem>

  </itemizedlist>
 </sect2>
</sect1>


<sect1 id="release-4-0-19">
 <title>リリース 4.0.19</title>
  <note>
   <title>リリース日</title>
   <simpara>2022-05-19</simpara>
  </note>

 <sect2>
  <title>変更点</title>
  <itemizedlist>
   <listitem>
    <!--
    2022-05-16 [4d224d9]
    -->
    <para>
     <productname>Pgpool-II</productname>メインプロセスの停止を強化しました。(Tatsuo Ishii)
    </para>
    <para>
     「pgpool stop」が一定期間（現在5秒）以内にメインプロセスを終了できなかった場合は、信号を再送信するように修正しました。
    </para>
   </listitem>

   <listitem>
    <!--
    2022-05-02 [a9389b9]
    -->
    <para>
     <xref linkend="pcp-proc-count">コマンドのPIDの長さを7文字に変更しました。(Bo Peng)
    </para>
   </listitem>

   <listitem>
    <!--
    2022-03-12 [dd502b6]
    -->
    <para>
     Parseメッセージ処理のエラーメッセージにメッセージの種類、バックエンドノードIDを含めるように改善しました。(Tatsuo Ishii)
    </para>
   </listitem>

   <listitem>
    <!--
    2022-03-11 [a44d364]
    -->
    <para>
     ParameterStatusメッセージのログレベルをLOGからDEBUG5にダウングレードしました。(Tatsuo Ishii)
    </para>
    <para>
     Discussion: <ulink url="https://www.pgpool.net/pipermail/pgpool-general/2022-March/008101.html">[pgpool-general: 8042]</ulink>
    </para>
   </listitem>

   <listitem>
    <!--
    2022-02-28 [fbe2f31]
    2022-02-28 [2bbc376]
    -->
    <para>
     <xref linkend="guc-pcp-listen-addresses">のデフォルト値を「*」から「localhost」に変更しました。(Tatsuo Ishii)
    </para>
   </listitem>

   <listitem>
    <!--
    2022-02-01 [50425a7]
    -->
    <para>
     <xref linkend="pcp-watchdog-info">のフィールド名を変更しました。(Muhammad Usama)
    </para>
   </listitem>

  </itemizedlist>
 </sect2>

 <sect2>
  <title>不具合修正</title>
  <itemizedlist>
   <listitem>
    <!--
    2022-04-27 [3337aa8]
    -->
    <para>
     lost状態のリモート<productname>Pgpool-II</productname>ノードが再起動後にクラスタに再参加できない問題を修正しました。(Muhammad Usama)
    </para>
    <para>
     報告: <ulink url="https://www.pgpool.net/pipermail/pgpool-general/2021-November/007954.html">[pgpool-general: 7896]</ulink>
    </para>
   </listitem>

   <listitem>
    <!--
    2022-04-14 [8677cd7]
    -->
    <para>
     無限待機の可能性を回避するために、<productname>Pgpool-II</productname>メインプロセスのexit_handlerを修正しました。(Tatsuo Ishii)
    </para>
   </listitem>

   <listitem>
    <!--
    2022-03-04 [6416f43]
    -->
    <para>
     プライマリ検索中にバックエンドが失敗またはシャットダウンした場合にPgpool-IIのメインプロセスが終了してしまう問題を修正しました。(Tatsuo Ishii)
    </para>
   </listitem>

   <listitem>
    <!--
    2022-03-03 [507feea]
    -->
    <para>
     Watchdogで発生するセグメンテーション違反を修正しました。(Muhammad Usama)
    </para>
    <para>
     Discussion: <ulink url="https://www.pgpool.net/pipermail/pgpool-general/2022-March/008089.html">[pgpool-general: 8030]</ulink>
    </para>
   </listitem>
  </itemizedlist>
 </sect2>

 <sect2>
  <title>ドキュメント修正</title>
  <itemizedlist>
   <listitem>
    <!--
    2022-05-09 [7bbf94f]
    -->
    <para>
     Doc: 設定例を更新しました。(Masaya Kawamoto)
    </para>
   </listitem>

   <listitem>
    <!--
    2022-04-28 [d5b2555]
    2022-04-28 [4feedf0]
    -->
    <para>
     Doc: pcp_watchdog_infoの出力例を更新しました。(Bo Peng)
    </para>
   </listitem>

   <listitem>
    <!--
    2022-04-28 [1b20d7b]
    -->
    <para>
     Doc: pg_encの引数として「$」文字を含むパスワードを指定する場合は、エスケープする必要があることを注意事項に追加しました。(Bo Peng)
    </para>
   </listitem>

  </itemizedlist>
 </sect2>

 <sect2>
  <title>回帰テスト修正</title>
  <itemizedlist>
   <listitem>
    <!--
    2022-04-17 [72d31b0]
    -->
    <para>
     タイムアウトエラーを回避するために、リグレッションテスト074.bug700_memqcache_segfaultを強化しました。(Tatsuo Ishii)
    </para>
   </listitem>

   <listitem>
    <!--
    2022-04-19 [7aed95e]
    -->
    <para>
     セグメンテーション違反を検出するようにテストスクリプトを改善しました。(Bo Peng)
    </para>
   </listitem>
  </itemizedlist>
 </sect2>
</sect1>

<sect1 id="release-4-0-18">
 <title>リリース 4.0.18</title>
  <note>
   <title>リリース日</title>
   <simpara>2022-02-17</simpara>
  </note>

 <sect2>
  <title>変更点</title>
  <itemizedlist>

   <listitem>
    <!--
    2022-01-06 [34c0c8d9]
    -->
    <para>
     <varname>in_hot_standby</varname>によるメッセージ長の違いに関する不要なログを抑制しました。(Tatsuo Ishii)
    </para>
    <para>
     PostgreSQL 14 は新しいパラメータを導入しました: <ulink url="https://www.postgresql.org/docs/14/runtime-config-preset.html">in_hot_standby</ulink>
    </para>
    <para>
     この値はスタンバイサーバの場合は "on" で、プライマリサーバの場合は "off" になります。
     その結果 pgpool のログは以下のメッセージで溢れていました。
    </para>

    <programlisting>
     LOG:  reading message length
     DETAIL:  message length (22) in slot 1 does not match with slot 0(23)
    </programlisting>

    <para>
     これを防ぐために、パラメータ名が<varname>in_hot_standby</varname>でない場合にのみログを出力するようになりました。
    </para>
    <para>
     また、メッセージにパラメータ名を表示するようになりました。例を示します。
    </para>

    <programlisting>
     LOG:  ParameterStatus "TimeZone": node 1 message length 30 is different from main node message length 24
    </programlisting>

    <para>
     Discussion: <ulink url="https://www.pgpool.net/pipermail/pgpool-hackers/2021-December/004077.html">[pgpool-hackers: 4076]</ulink>
    </para>
   </listitem>

   <listitem>
    <!--
    2022-02-13 [b5701e05]
    -->
    <para>
     パラメータステータスの取り扱いを変更しました。(Tatsuo Ishii)
    </para>
    <para>
     バックエンドからパラメータステータスのメッセージが届いたときにただメモリー上に記憶するだけでなく、フロントエンドに転送するようになりました。
    </para>
   </listitem>

  </itemizedlist>
 </sect2>

 <sect2>
  <title>不具合修正</title>
  <itemizedlist>

   <listitem>
    <!--
    2022-01-31 [da2b7f13]
    -->
    <para>
     <command>pcp_node_info</command>の実行の際に長時間待機する不具合を修正しました。(Tatsuo Ishii)
    </para>
    <para>
     Discussion: <ulink url="https://www.pgpool.net/pipermail/pgpool-hackers/2022-January/004110.html">[pgpool-hackers: 4109]</ulink>
    </para>
   </listitem>

   <listitem>
    <!--
    2022-02-02 [59cb9418]
    -->
    <para>
     <productname>Coverity</productname>によって見つかったヘルスチェックプロセスの問題を修正しました。(Tatsuo Ishii)
    </para>
   </listitem>

   <listitem>
    <!--
    2022-02-02 [5e39be1f]
    -->
    <para>
     <productname>Coverity</productname>によって見つかったメモリリークを修正しました。(Tatsuo Ishii)
    </para>
   </listitem>

   <listitem>
    <!--
    2022-02-06 [f87d3b51]
    -->
    <para>
     プライマリノードが存在しない場合の対処をするように<function>failover()</function>を修正しました。(Tatsuo Ishii)
    </para>
    <para>
     プライマリノードが存在しない場合に pgpool が起動したときなど<varname>Req_info->primary_node_id</varname>が -1 である場合に<function>failover()</function>は<function>find_primary_node_repeatedly()</function>の呼び出しをスキップしていました。
     また、<varname>follow_master_command</varname>も実行されませんでした。
    </para>
    <para>
     Discussion: <ulink url="https://www.pgpool.net/pipermail/pgpool-hackers/2022-February/004114.html">[pgpool-hackers: 4113]</ulink>
    </para>
   </listitem>

   <listitem>
    <!--
    2022-02-10 [9418df10]
    -->
    <para>
     バックエンドに接続できないときにストリーミングレプリケーションチェックプロセスがリトライしないように修正しました。(<ulink url="https://www.pgpool.net/mantisbt/view.php?id=742">bug 742</ulink>)(Bo Peng)
    </para>
    <para>
     このリトライによってフェイルオーバに時間がかかっていました。
    </para>
   </listitem>

  </itemizedlist>
 </sect2>

 <sect2>
  <title>ドキュメント修正</title>
  <itemizedlist>

   <listitem>
    <!--
    2022-01-04 [beb17035]
    -->
    <para>
     ドキュメントの誤字を修正しました。(pengbo)
    </para>
    <para>
     パッチはUmar Hayatによって提供されました。
    </para>
   </listitem>

   <listitem>
    <!--
    2022-01-04 [6503b2cc]
    -->
    <para>
     <productname>PostgreSQL</productname> YUM リポジトリから<productname>Pgpool-II</productname>がインストールされないように /etc/yum.repos.d/pgdg-redhat-all.repo を"exclude"する設定を追加しました。(Bo Peng)
    </para>
   </listitem>

   <listitem>
    <!--
    2022-01-07 [019bc2f9]
    -->
    <para>
     <varname>ParameterStatus</varname>と<varname>in_hot_standby</varname>パラメータに関する制約を追加しました。(Tatsuo Ishii)
    </para>
   </listitem>

   <listitem>
    <!--
    2022-02-02 [5cd03ce7]
    -->
    <para>
     <varname>set_config</varname>に関する制約を追加しました。(Tatsuo Ishii)
    </para>
   </listitem>

  </itemizedlist>
 </sect2>

 <sect2>
  <title>テストツール修正</title>
  <itemizedlist>

   <listitem>
    <!--
    2022-02-06 [c58fcb94]
    2022-02-07 [3192ba94]
    -->
    <para>
     <command>pgpool_setup</command>が作成するfailoverスクリプトを修正しました。(Tatsuo Ishii)
    </para>
    <para>
     <command>pgpool_setup</command>が<filename>failover.sh</filename>を作成するとき、プライマリサーバが存在しない場合を考慮していませんでした。
    </para>
   </listitem>

  </itemizedlist>
 </sect2>

 <sect2>
  <title>回帰テスト修正</title>
  <itemizedlist>

   <listitem>
    <!--
    2021-12-22 [022ba990]
    -->
    <para>
     再コンパイルしないで既存のインストールで回帰テストを実行できるようになりました。(Tatsuo Ishii)
    </para>
    <para>
     Discussion: <ulink url="https://www.pgpool.net/pipermail/pgpool-hackers/2021-December/004078.html">[pgpool-hackers: 4077]</ulink>
    </para>
   </listitem>

   <listitem>
    <!--
    2022-01-13 [dba249f8]
    -->
    <para>
     noinstall モード時の<command>pgpool_setup</command>と<command>watchdog_setup</command>のバイナリパスを修正しました。(Bo Peng)
    </para>
   </listitem>

  </itemizedlist>
 </sect2>
</sect1>

<sect1 id="release-4-0-17">
 <title>リリース 4.0.17</title>
  <note>
   <title>リリース日</title>
   <simpara>2021-12-23</simpara>
  </note>

 <sect2>
  <title>変更点</title>
  <itemizedlist>

   <listitem>
    <!--
    2021-12-03 [74715470]
    -->
    <para>
     yaccとの非互換性によって出力されるbisonの警告を抑制しました。(Tatsuo Ishii)
    </para>
   </listitem>

   <listitem>
    <!--
    2021-11-22 [609f3c98]
    -->
    <para>
     冗長なコードを修正しました。(Tatsuo Ishii)
    </para>
    <para>
     パッチはLu Chenyangによって提供されました。
    </para>
   </listitem>

  </itemizedlist>
 </sect2>

 <sect2>
  <title>ドキュメント修正</title>
  <itemizedlist>

   <listitem>
    <!--
    2021-12-10 [31036ae1]
    -->
    <para>
     Doc: <command>pcp_watchdog_info</command>マニュアルの誤字を修正しました。(Tatsuo Ishii)
    </para>
   </listitem>

   <listitem>
    <!--
    2021-11-25 [a2c9d6ea]
    -->
    <para>
     Doc: リリースノートの誤字を修正しました。(Bo Peng)
    </para>
   </listitem>

  </itemizedlist>
 </sect2>
</sect1>

<sect1 id="release-4-0-16">
 <title>リリース 4.0.16</title>
  <note>
   <title>リリース日</title>
   <simpara>2021-11-18</simpara>
  </note>

 <sect2>
  <title>セキュリティリリース</title>
  <itemizedlist>
   <listitem>
    <!--
    2021-11-17 [fbe1d417]
    -->
    <para>
     SSL暗号化ハンドシェイク後の余計なデータを拒否するようにしました。(Tatsuo Ishii)
    </para>
    <para>
     サーバサイドのSSLネゴシエーションの実装において、任意のSQLコマンドを実行できる中間者攻撃が可能でした。
     これはPgpool-IIがクライアント認証で証明書認証を使用しているか、hotssl + trust認証の場合に可能でした。
     PostgreSQLのCVE-2021-23214と似た脆弱性です。
    </para>
    <para>
     同様に、クライアントサイドのSSLネゴシエーション実装において、任意の結果に改ざんする中間者攻撃が可能でした。
     これはPostgreSQLがクライアント認証でhostssl + trust認証を使用しているときに可能でした。
     証明書認証の場合には、Pgpool-IIはPgpool-IIとPostgreSQL間で証明書認証を実装していないため問題ありません。
     PostgreSQLのCVE-2021-23222と似た脆弱性です。
    </para>
   </listitem>
  </itemizedlist>
 </sect2>

 <sect2>
  <title>変更点</title>
  <itemizedlist>

   <listitem>
    <!--
    2021-11-16 [2e70bede]
    -->
    <para>
     <command>pg_terminate_backend()</command>の処理に関する<productname>PostgreSQL 14</productname>対応をしました。(Tatsuo Ishii)
    </para>
   </listitem>

   <listitem>
    <!--
    2021-10-24 [ca7e6f80]
    -->
    <para>
     <productname>Pgpool-II</productname>メインプロセスのSIGCHLDハンドラを改良しました。(Tatsuo Ishii)
    </para>
    <para>
     <productname>Pgpool-II</productname>の子プロセスがSIGKILLシグナルでkillされたとき、SIGCHLDハンドラは他のシグナルと同じようにLOGレベルメッセージを発していました。
     しかし、SIGKILLシグナルはOMM killerによるkillなど重要なイベントなので、WARNINGレベルのメッセージを発するようにしました。
     Michail Alexakisから提案されました。
     Discussion: <ulink url="https://www.pgpool.net/pipermail/pgpool-general/2021-October/007808.html">[pgpool-general: 7750]</ulink>
    </para>
   </listitem>

  </itemizedlist>
 </sect2>

 <sect2>
  <title>不具合修正</title>
  <itemizedlist>

   <listitem>
    <!--
    2021-09-16 [8ade8307]
    -->
    <para>
     <command>COPY FROM</command>中のハングアップを修正しました。(Tatsuo Ishii)
    </para>
    <para>
     <command>COPY FROM</command>中にエラーが発生したとき、<productname>Pgpool-II</productname>はフロントエンドから<command>COPY</command>終了マーカーが送信されたあと、バックエンドからの応答を永遠に待っている可能性がありました。
     Bo Pengによって発見されました。
    </para>
   </listitem>

   <listitem>
    <!--
    2021-08-18 [08fdd1f6]
    -->
    <para>
     rawモードでの誤った負荷分散ノードの表示を修正しました。(Bo Peng)
    </para>
    <para>
     rawモードでは、<productname>Pgpool-II</productname>はすべてのクエリをメインノードに送信します。
     この不具合は表示上の問題だけで、クエリの転送処理に影響はないですが、ユーザを混乱させる可能性があるので、修正しました。
    </para>
   </listitem>

   <listitem>
    <!--
    2021-08-08 [519e0e06]
    -->
    <para>
     <command>PGPOOL SHOW ALL</command>の実行結果に<varname>backend_flag*</varname>が2回表示される不具合を修正しました。(Tatsuo Ishii)
    </para>
   </listitem>

  </itemizedlist>
 </sect2>

 <sect2>
  <title>ドキュメント修正</title>
  <itemizedlist>

   <listitem>
    <!--
    2021-10-06 [42a77d8c]
    -->
    <para>
     Doc: ドキュメントのtypoを修正しました。(Bo Peng)
    </para>
   </listitem>

   <listitem>
    <!--
    2021-10-04 [0fdfd9d1]
    -->
    <para>
     typoを修正しました。(Bo Peng)
    </para>
    <para>
     パッチはKazufumi Notoによって提供されました。
    </para>
   </listitem>

   <listitem>
    <!--
    2021-08-09 [320c02bb]
    -->
    <para>
     Doc: <command>PGPOOL SHOW</command>コマンドを実行する際に、大文字を含むパラメータ名の場合には、
     パラメータ名をダブルクォートで囲んで実行する必要があることを追加しました。(Bo Peng)
    </para>
   </listitem>

  </itemizedlist>
 </sect2>

 <sect2>
  <title>テストツール修正</title>
  <itemizedlist>
   <listitem>
    <!--
    2021-08-25 [89b29bd1]
    -->
    <para>
     新しいメインノードが利用できない場合に何もしないように<command>pgpool_setup</command>を修正しました。(Tatsuo Ishii)
    </para>
   </listitem>

  </itemizedlist>
 </sect2>

 <sect2>
  <title>回帰テスト修正</title>
  <itemizedlist>

   <listitem>
    <!--
    2021-11-16 [4f2f27aa]
    -->
    <para>
     たまに発生する073.pg_terminate_backendの失敗を修正しました。(Tatsuo Ishii)
    </para>
   </listitem>

   <listitem>
    <!--
    2021-11-08 [51ca14bc]
    -->
    <para>
     テスト074の名前を変更しました。(Bo Peng)
    </para>
   </listitem>

   <listitem>
    <!--
    2021-09-23 [e31cf0e8]
    -->
    <para>
     テストの失敗を防ぐためにpsqlコマンドのパスを修正しました。(Bo Peng)
    </para>
   </listitem>

  </itemizedlist>
 </sect2>
</sect1>

<sect1 id="release-4-0-15">
 <title>リリース 4.0.15</title>
  <note>
   <title>リリース日</title>
   <simpara>2021-08-05</simpara>
  </note>

 <sect2>
  <title>変更点</title>
  <itemizedlist>

   <listitem>
    <!--
    2021-05-27 [6cd7ee4]
    -->
    <para>
     ドメイン名を含めたホスト名の長さの最大値を変更しました。(Tatsuo Ishii)
    </para>
    <para>
     ホスト名の長さの最大値を128にしていましたが、正しくは254でした。
     Discussion: <ulink url="https://www.pgpool.net/pipermail/pgpool-hackers/2021-May/003904.html">[pgpool-hackers: 3903]</ulink>
    </para>
   </listitem>

  </itemizedlist>
 </sect2>

 <sect2>
  <title>不具合修正</title>
  <itemizedlist>

   <listitem>
    <!--
    2021-07-07 [740befe]
    -->
    <para>
     クエリキャッシュで<varname>SQLValueFunctions</varname>を含むクエリをキャッシュしないようにしました。(Tatsuo Ishii)
    </para>
    <para>
     <varname>SQLValueFunctions</varname>の一覧は以下になります。
     <itemizedlist>
      <listitem>
       <para>
        CURRENT_DATE
       </para>
      </listitem>
      <listitem>
       <para>
        CURRENT_TIME
       </para>
      </listitem>
        <listitem>
       <para>
        CURRENT_TIMESTAMP
       </para>
      </listitem>
        <listitem>
       <para>
        LOCALTIME
       </para>
      </listitem>
        <listitem>
       <para>
        LOCALTIMESTAMP
       </para>
      </listitem>
        <listitem>
       <para>
        CURRENT_ROLE
       </para>
      </listitem>
        <listitem>
       <para>
        CURRENT_USER
       </para>
      </listitem>
      <listitem>
       <para>
        SESSION_USER
       </para>
      </listitem>
      <listitem>
       <para>
        USER
       </para>
      </listitem>
      <listitem>
       <para>
        CURRENT_CATALOG
       </para>
      </listitem>
      <listitem>
       <para>
        CURRENT_SCHEMA
       </para>
      </listitem>
     </itemizedlist>
    </para>
   </listitem>

   <listitem>
    <!--
    2021-07-01 [314e1b8]
    -->
    <para>
     SIモードにおける不正なメッセージの送信を修正しました。(Tatsuo Ishii)
    </para>
    <para>
     クエリがシリアル化エラーなどの特定の理由によってアボートしたとき、<productname>Pgpool-II</productname>は
     メインノード以外で実行されているトランザクションを中止するためにエラークエリを送信します。そのメッセージ長が
     正しくなかったためバックエンドで「invalid string in message」エラーが発生していました。
    </para>
   </listitem>

   <listitem>
    <!--
    2021-05-22 [d89546b]
    -->
    <para>
     watchdog通信の競合状態を修正しました。(Tatsuo Ishii)
    </para>
    <para>
     メインプロセスがwatchdogプロセスから通知された処理を実行中に、watchdogプロセスが新しいメッセージを
     メインプロセスに通知したとき、新しいメッセージが処理されるまでに大幅な遅延が発生していました。
     Discussion: <ulink url="https://www.pgpool.net/pipermail/pgpool-hackers/2021-May/003901.html">[pgpool-hackers: 3900]</ulink>
    </para>
   </listitem>

   <listitem>
    <!--
    2021-05-20 [95e500c]
    -->
    <para>
     再起動後にwatchdogノードステータスが更新されない問題を修正しました。
     (<ulink url="https://www.pgpool.net/mantisbt/view.php?id=684">bug 684</ulink>) (Muhammad Usama)
    </para>
   </listitem>

  </itemizedlist>
 </sect2>

 <sect2>
  <title>ドキュメント修正</title>
  <itemizedlist>

   <listitem>
    <!--
    2021-07-14 [34aaa9c]
    -->
    <para>
     Doc: いくつかのドキュメントのtypoを修正しました。(Bo Peng)
    </para>
   </listitem>

   <listitem>
    <!--
    2021-07-07 [436e95d]
    -->
    <para>
     Doc: インメモリクエリキャッシュのtypoを修正しました。(Tatsuo Ishii)
    </para>
   </listitem>

   <listitem>
    <!--
    2021-06-02 [b5efa03]
    -->
    <para>
     Doc: <xref linkend="GUC-WD-LIFE-POINT">の説明を修正しました。(Masaya Kawamoto)
    </para>
   </listitem>

  </itemizedlist>
 </sect2>

 <sect2>
  <title>テストツール修正</title>
  <itemizedlist>

   <listitem>
    <!--
    2021-06-28 [f3b26a5]
    -->
    <para>
     <command>pgpool_setup</command>で使用されるrsyncのパラメータを修正しました。(Tatsuo Ishii)
    </para>
   </listitem>

   <listitem>
    <!--
    2021-06-15 [9121c0c]
    -->
    <para>
     <command>pgpool_setup</command>中のベースバックアップ処理を修正しました。(Tatsuo Ishii)
    </para>
   </listitem>

   <listitem>
    <!--
    2021-05-29 [ce33dd8]
    -->
    <para>
     <command>watchdog_setup</command>のスクリプトを修正しました。(Tatsuo Ishii)
    </para>
    <para>
     <command>watchdog_setup</command>によって生成されるshutdownallスクリプトは、全体シャットダウンでは
     不必要なフェイルオーバ処理を引き起こしていました。
    </para>
   </listitem>

  </itemizedlist>
 </sect2>

 <sect2>
  <title>回帰テスト修正</title>
  <itemizedlist>

   <listitem>
    <!--
    2021-06-21 [99e99fc]
    -->
    <para>
     031.connection_life_timeの不具合を修正しました。(Tatsuo Ishii)
    </para>
   </listitem>

  </itemizedlist>
 </sect2>
</sect1>

<sect1 id="release-4-0-14">
 <!--
 <title>Release 4.0.14</title>
 -->
 <title>リリース 4.0.14</title>
 <note>
  <!--
  <title>Release Date</title>
  -->
  <title>リリース日</title>
  <simpara>2021-05-20</simpara>
 </note>

 <sect2>
  <!--
  <title>Bug fixes</title>
  -->
  <title>不具合修正</title>
  <itemizedlist>
   <listitem>
    <!--
    2021-05-11 [241bee3]
    -->
    <para>
     Doc: <xref linkend="guc-heartbeat-device">の説明を修正しました。(Tatsuo Ishii)
    </para>
    <para>
     <xref linkend="guc-heartbeat-device">パラメータは、<productname>Pgpool-II</productname>がrootで起動する場合にのみ使用できます。
    </para>
   </listitem>

   <listitem>
    <!--
    2021-05-05 [049a1b6]
    -->
    <para>
     database/app_name_redirect_preference_listがステートメントレベル負荷分散モードで正しく動作しない不具合を修正しました。
     (<ulink url="https://www.pgpool.net/mantisbt/view.php?id=707">bug 707</ulink>) (Bo Peng)
    </para>
   </listitem>

   <listitem>
    <!--
    2021-04-30 [f1e2b71]
    -->
    <para>
     pgpool0の配下のみにデータベースクラスタを作成するように<xref linkend="watchdog-setup">を修正しました。(Tatsuo Ishii)
    </para>
   </listitem>

   <listitem>
    <!--
    2021-04-09 [16d07f7]
    -->
    <para>
     クエリキャッシュが有効になっている場合のpgpoolのクラッシュを修正しました。
     (<ulink url="https://www.pgpool.net/mantisbt/view.php?id=700">bug 700</ulink>) (Tatsuo Ishii)
    </para>
    <para>
     ストリーミングレプリケーションモードと論理レプリケーションモード以外でCloseCompleteを受信すると、Pgpool-IIがクラッシュしていました。
    </para>
   </listitem>

   <listitem>
    <!--
    2021-04-05 [7d54c1b]
    -->
    <para>
     クエリキャッシュがストリーミングレプリケーションモードと論理レプリケーションモード以外で作成されない不具合を修正しました。(Tatsuo Ishii)
    </para>
   </listitem>

   <listitem>
    <!--
    2021-03-16 [f07fdb0]
    -->
    <para>
     Startupパケットを受信したときのデバッグメッセージを改善しました。 (Tatsuo Ishii)
    </para>
   </listitem>

   <listitem>
    <!--
    2021-05-09 [9971171]
    2021-05-05 [96578bd]
    2021-05-04 [69f3c9b]
    2021-04-20 [6150d26]
    2021-04-20 [d5469da]
    2021-04-13 [b3bddbe]
    2021-02-20 [d9f25b8]
    -->
    <para>
     Doc: 多数ドキュメントの改善を行いました。 (Tatsuo Ishii, Bo Peng)
    </para>
   </listitem>
  </itemizedlist>
 </sect2>
</sect1>

<sect1 id="release-4-0-13">
 <!--
 <title>Release 4.0.13</title>
 -->
 <title>リリース 4.0.13</title>
 <note>
  <!--
  <title>Release Date</title>
  -->
  <title>リリース日</title>
  <simpara>2021-02-18</simpara>
 </note>

 <sect2>
  <!--
  <title>Changes</title>
  -->
  <title>変更点</title>
  <itemizedlist>
   <listitem>
    <!--
    2020-12-08 [db613fd]
    -->
    <para>
     <productname>Pgpool-II</productname>起動時に既存のwatchdogコマンドソケットファイルを削除するように修正しました。(Muhammad Usama)
    </para>
    <para>
     パッチはMasaya Kawamotoによって提供されました。
    </para>
   </listitem>
  </itemizedlist>
 </sect2>

 <sect2>
  <!--
  <title>Bug fixes</title>
  -->
  <title>不具合修正</title>
  <itemizedlist>
   <listitem>
    <!--
    2021-02-14 [4ddfe82]
    -->
    <para>
     <xref linkend="PGPOOL-ADM-PCP-NODE-INFO">の誤ったweightの表示を修正しました。 (Tatsuo Ishii)
    </para>
   </listitem>

   <listitem>
    <!--
    2021-02-08 [9b251e0]
    -->
    <para>
     Watchdogリーダーによる同期処理後に、ヘルスチェックプロセスが起動されない不具合を修正しました。(Tatsuo Ishii)
    </para>
   </listitem>

   <listitem>
    <!--
    2021-02-04 [62b9d9a]
    -->
    <para>
     <command>watchdog_setup</command>の誤ったデータベースクラスタのパスを修正しました。(Tatsuo Ishii)
    </para>
   </listitem>

   <listitem>
    <!--
    2021-01-24 [eefe912]
    -->
    <para>
     DBノードごとに個別のアーカイブディレクトリを作成するように<command>pgpool_setup</command>を修正しました。(Tatsuo Ishii)
    </para>
   </listitem>

   <listitem>
    <!--
    2021-02-02 [843b953]
    -->
    <para>
     ヘルスチェックプロセス起動時のメッセージを修正しました。(Tatsuo Ishii)
    </para>
   </listitem>

   <listitem>
    <!--
    2021-02-01 [c03c49f]
    -->
    <para>
     Doc: サンプルスクリプトはテーブルスペースをサポートしていないことをドキュメント「Pgpool-II + Watchdogの構築の例」に追加しました。(Bo Peng)
    </para>
   </listitem>

   <listitem>
    <!--
    2021-01-13 [d36cc99]
    -->
    <para>
     共有メモリの割り当て中のエラーを修正しました。(Tatsuo Ishii)
    </para>
   </listitem>

   <listitem>
    <!--
    2021-01-01 [08db48f]
    -->
    <para>
     ERRORが発生した場合、<xref linkend="GUC-CHILD-MAX-CONNECTIONS">が正しくカウンタされない不具合を修正しました。(Tatsuo Ishii)
    </para>
   </listitem>

   <listitem>
    <!--
    2020-12-15 [59d7431]
    2020-12-13 [00d103f]
    -->
    <para>
     backend_flag0 = 'ALWAYS_PRIMARY|ALLOW_TO_FAILOVER'またはfailover_command=''の場合に発生しうるセグメンテーション違反を修正しました。
     (<ulink url="https://www.pgpool.net/mantisbt/view.php?id=672">bug 672</ulink>) (Tatsuo Ishii)
    </para>
   </listitem>

   <listitem>
    <!--
    2020-11-30 [86d4dd0]
    -->
    <para>
     <filename>pool_passwd</filename>のファイルスワッピングの競合状態を修正しました。(Tatsuo Ishii)
    </para>
    <para>
     パッチはMasaya Kawamotoによって提供されました。
    </para>
   </listitem>
   <listitem>
    <!--
    2020-11-20 [14dadc6]
    -->
    <para>
     Doc: <xref linkend="GUC-LOG-STANDBY-DELAY">のドキュメントを修正しました。(Tatsuo Ishii)
    </para>
   </listitem>
  </itemizedlist>
 </sect2>
</sect1>

<sect1 id=release-4-0-12>
 <!--
 <title>Release 4.0.12</title>
 -->
 <title>リリース 4.0.12</title>
 <note>
  <!--
  <title>Release Date</title>
  -->
  <title>リリース日</title>
  <simpara>2020-11-19</simpara>
 </note>

 <sect2>
  <!--
  <title>Changes</title>
  -->
  <title>変更点</title>
  <itemizedlist>
   <listitem>
    <!--
    2020-11-17 [544cb97]
    -->
    <para>
     Doc: ドキュメントの「Auroraの設定例」を更新しました。(Bo Peng)
    </para>
   </listitem>

   <listitem>
    <!--
    2020-10-03 [e24d792]
    -->
    <para>
     Doc: <productname>Pgpool-II</productname>が<acronym>GSSAPI</acronym>をサポートしないという注意事項を追加しました。(Tatsuo Ishii)
    </para>
   </listitem>

   <listitem>
    <!--
    2020-10-03 [db31d2c]
    -->
    <para>
	 フロントエンドが<acronym>GSSAPI</acronym>暗号化接続を要求した場合、
	 <productname>Pgpool-II</productname>は<acronym>GSSAPI</acronym>をサポートしていないため、
	 これまでエラーを返していましたが、他の方式での接続を要求するように変更しました。(Bo Peng)
    </para>
    <para>
     パッチはTatsuo Ishiiにより作成され、Umar Hayatによりレビュー・テストされました。
    </para>
   </listitem>
  </itemizedlist>
 </sect2>

 <sect2>
  <!--
  <title>Bug fixes</title>
  -->
  <title>不具合修正</title>
  <itemizedlist>
   <listitem>
    <!--
    2020-11-17 [94cbceb]
    -->
    <para>
	 ネイティブレプリケーションモードで「INSERT ... ON CONFLICT」クエリ書換えの不具合を修正しました。
     (<ulink url="https://www.pgpool.net/mantisbt/view.php?id=654">bug 654</ulink>) (Bo Peng)
    </para>
   </listitem>

   <listitem>
    <!--
    2020-10-30 [37d32b9]
    -->
    <para>
	 クエリがキャンセルされたときにコネクションカウントが減少しない不具合を修正しました。
     (<ulink url="https://www.pgpool.net/mantisbt/view.php?id=656">bug 656</ulink>) (Tatsuo Ishii)
    </para>
   </listitem>

   <listitem>
    <!--
    2020-09-30 [3cd8c2b]
    -->
    <para>
     Doc: <productname>PostgreSQL</productname>の使用可能なバージョンを7.4以降に修正しました。(Tatsuo Ishii)
    </para>
   </listitem>
  </itemizedlist>
 </sect2>
</sect1>

<sect1 id=release-4-0-11>
 <!--
 <title>Release 4.0.11</title>
 -->
 <title>リリース 4.0.11</title>
 <note>
  <!--
  <title>Release Date</title>
  -->
  <title>リリース日</title>
  <simpara>2020-09-17</simpara>
 </note>

 <sect2>
  <!--
  <title>Changes</title>
  -->
  <title>変更点</title>
  <itemizedlist>
   <listitem>
    <!--
    2020-09-13 [4e1771e]
    -->
    <para>
     <!--
     Follow the guide line of PostgreSQL 12.4 regarding extensions. (Tatsuo Ishii)
     -->
	 <productname>PostgreSQL</productname> 12.4 のガイドラインに従って<productname>Pgpool-II</productname>の拡張機能のスクリプトを修正しました。(Tatsuo Ishii)
    </para>
    <para>
     <!--
     CREATE OR REPLACE FUNCTION should be avoided. Use CREATE FUNCTION instead.
     -->
	 <command>CREATE OR REPLACE FUNCTION</command>の使用を避けて、代わりに<command>CREATE FUNCTION</command>を使用するように修正しました。
    </para>
   </listitem>

   <listitem>
    <!--
    2020-08-24 [0d184da]
    -->
    <para>
     <!--
     Replace "PGBIN" and "LPATH" in pgpool_setup and watchdog_setup using PostgreSQL's bin path and lib path. (Bo Peng)
     -->
	 <xref linkend="PGPOOL-SETUP">と<xref linkend="WATCHDOG-SETUP">の"PGBIN"と"LPATH"を、PostgreSQLのbin pathとlib pathにしました。(Bo Peng)
    </para>
   </listitem>
  </itemizedlist>
 </sect2>

 <sect2>
  <!--
  <title>Bug fixes</title>
  -->
  <title>不具合修正</title>
  <itemizedlist>
   <listitem>
    <!--
    2020-09-16 [957d3b3]
    -->
    <para>
     <!--
     Doc: fix the incorrect description regarding the running modes of Pgpool-II in which online recovery is available. (Bo Peng)
     -->
     Doc: オンラインリカバリが利用可能なPgpool-IIの動作モードに関する誤った説明を修正しました。(Bo Peng)
    </para>
   </listitem>

   <listitem>
    <!--
    2020-09-14 [f238eb6]
    -->
    <para>
     <!--
     Remove unnecessary checks in some code path. (Tatsuo Ishii)
     -->
	 いくつかの不要なチェックをソースコードから削除しました。(Tatsuo Ishii)
    </para>
    <para>
     <!--
     Patch contributed by Hou, Zhijie.
     -->
	 パッチはby Hou, Zhijieにより提供されました。
    </para>
   </listitem>

   <listitem>
    <!--
    2020-09-06 [54f7767]
    -->
    <para>
     <!--
     Fix relcache query sometimes sent to other than primary. (Tatsuo Ishii)
     -->
	 relcacheクエリがプライマリ以外に送信される不具合を修正しました。(Tatsuo Ishii)
    </para>
    <para>
     <!--
     In streaming replication mode, relcache queries are supposed to be
     sent to the primary node.  But actually they were not sent to the primary
     node if primary node was not the master node. Typically this could
     happen when the primary is not node 0.
     -->
	 ストリーミングレプリケーションモードでは、relcacheクエリはプライマリノードに送信されるようになっています。
     しかし、実際には、プライマリノードがマスターノードでない場合、relcacheクエリはプライマリノードに送信されませんでした。
     通常、これはプライマリがノード0でない場合に発生する可能性があります。
    </para>
   </listitem>

   <listitem>
    <!--
    2020-09-01 [8ffd26b]
    -->
    <para>
     <!--
     Fix connection_life_time not working when serialize_accept is enabled. (Tatsuo Ishii)
     -->
	 <xref linkend="GUC-SERIALIZE-ACCEPT">が有効になっているときに<xref linkend="GUC-CONNECTION-LIFE-TIME">が機能しない問題を修正しました。(Tatsuo Ishii)
    </para>
    <para>
	 Discussion: <ulink url="https://www.pgpool.net/pipermail/pgpool-general/2020-August/007233.html">[pgpool-general: 7175]</ulink>
    </para>
   </listitem>

   <listitem>
    <!--
    2020-08-30 [1baf413]
    -->
    <para>
     <!--
     Display more informative error message in authentication process. (Tatsuo Ishii)
     -->
	 認証処理において有益なエラーメッセージを表示するように修正しました。(Tatsuo Ishii)
    </para>
   </listitem>

   <listitem>
    <!--
    2020-08-21 [aa1a170]
    -->
    <para>
     <!--
     Fix segfault in pgpool child process in certain case. (Tatsuo Ishii)
     -->
	 特定の場合に発生するpgpool子プロセスのセグメンテーション違反を修正しました。(Tatsuo Ishii)
    </para>
    <para>
     <!--
	 This issue can be reproduced with the following steps:
     -->
	 以下の方法で再現できます。
     <orderedlist>
	  <listitem>
	   <para>
        <!--
        shutdown all backends.
        -->
		すべてのバックエンドを停止します。
	   </para>
	  </listitem>
	  <listitem>
	   <para>
        <!--
        connect to pgpool with invalid client. I have used pcp_attach_node with pgpool's port number, not pcp's.
        -->
		無効なクライアントでpgpoolに接続します。例えば、pcpのポートではなく、pgpoolのポート番号を使用して<command>pcp_attach_node</command>を実行します。
	   </para>
	  </listitem>
     </orderedlist>
    </para>
   </listitem>
  </itemizedlist>
 </sect2>
</sect1>

<sect1 id=release-4-0-10>
 <!--
 <title>Release 4.0.10</title>
 -->
 <title>リリース 4.0.10</title>
 <note>
  <!--
  <title>Release Date</title>
  -->
  <title>リリース日</title>
  <simpara>2020-08-20</simpara>
 </note>

 <sect2>
  <!--
  <title>Changes</title>
  -->
  <title>変更点</title>
  <itemizedlist>
   <listitem>
    <!--
    2020-08-12 [8523d12]
    -->
    <para>
	 Doc: TLSバージョン1.2あるいはそれ以下のバージョンのみが<xref linkend="GUC-SSL-CIPHERS">の影響をうけるという説明を追加しました。(Tatsuo Ishii)
    </para>
   </listitem>

   <listitem>
    <!--
    2020-05-22 [fdd01d9]
    -->
    <para>
	 Doc: <xref linkend="GUC-WD-PRIORITY">に関する説明を改善しました。(Bo Peng)
    </para>
    <para>
     パッチはKenichiro Tanakaにより提供されました。
    </para>
   </listitem>

   <listitem>
    <!--
    2020-05-22 [a8e3712]
    -->
    <para>
	 <filename>pool_hba.conf</filename>サンプルファイルに<literal>hostssl/hostnossl</literal>に関する説明を追加しました。(Tatsuo Ishii)
    </para>
   </listitem>

   <listitem>
    <!--
    2020-07-17 [44096e2]
    2020-07-16 [5115de1]
    2020-06-30 [8941202]
    2020-05-30 [6f128fc]
    2020-05-23 [dde82d3]
    2020-05-23 [7a73705]
    2020-07-28 [1e13a96]
    -->
    <para>
	 Doc: 多数ドキュメントの改善を行いました。(Tatsuo Ishii)
    </para>
   </listitem>
  </itemizedlist>
 </sect2>

 <sect2>
  <!--
  <title>Bug fixes</title>
  -->
  <title>不具合修正</title>
  <itemizedlist>
   <listitem>
    <!--
    2020-08-12 [b2dbfe2]
    -->
    <para>
	 pgpoolの起動時に、pidファイルが存在する場合、書き込む前にpidファイルを長さゼロに切り詰めるように修正しました。(Bo Peng)
    </para>
    <para>
	 パッチはmaliangzhuにより提供されました。
    </para>
   </listitem>

   <listitem>
    <!--
    2020-08-11 [e402d68]
    -->
    <para>
	 Doc: <xref linkend="GUC-FAILBACK-COMMAND">のパラメータの説明の誤りを修正しました。(Bo Peng)
    </para>
   </listitem>

   <listitem>
    <!--
    2020-08-11 [96fa3c9]
    2020-08-15 [5ac2af1]
    -->
    <para>
	 ストリーミングレプリケーションモードでプライマリノードが0以外の場合、<xref linkend="guc-connection-life-time">が機能しない問題を修正しました。(Tatsuo Ishii)
    </para>
   </listitem>

   <listitem>
    <!--
    2020-08-05 [4bd2a0d]
    -->
    <para>
	 -rオプション及び<productname>PostgreSQL</productname> 12での<command>pgpool_setup</command>の問題を修正しました。(Tatsuo Ishii)
    </para>
   </listitem>

   <listitem>
    <!--
    2020-07-31 [8fb0b88]
    -->
    <para>
	 RPMパッケージのPCPコマンドの<literal>UNIX_DOMAIN_PATH</literal>を<filename>/var/run/postgresql</filename>に変更します。(Bo Peng)
    </para>
   </listitem>

   <listitem>
    <!--
    2020-08-05 [8108c40]
    2020-07-14 [70a2ac3]
    -->
    <para>
	 クエリキャッシュの不具合を修正しました。(Tatsuo Ishii)
    </para>
    <para>
	 クエリキャッシュが有効な場合、あるテーブルが更新された場合、<productname>Pgpool-II</productname>は自動的にそのテーブルに関係する全てのキャッシュを削除するようになっています。
	 しかし、<command>EXPLAIN ANALYZE</command>または<acronym>CTE</acronym>で更新クエリを実行した場合に、
	 これらのクエリが誤って参照クエリとして扱われ、キャッシュが削除されませんでした。
    </para>
    <para>
	 パッチはHou, Zhijieにより作成され、Tatsuo Ishiiにより修正されました。
    </para>
   </listitem>

   <listitem>
    <!--
    2020-07-09 [69ae44f]
    -->
    <para>
	 コーナーケースで発生する<productname>Pgpool-II</productname>のハングアップを修正しました。(Tatsuo Ishii)
    </para>
   </listitem>

   <listitem>
    <!--
    2020-06-26 [a312e4b]
    -->
    <para>
	 user、database、application_name以外のパラメータが指定された場合、startupパケットの読み取りが失敗する不具合を修正しました。(Tatsuo Ishii)
    </para>
   </listitem>

   <listitem>
    <!--
    2020-06-22 [a678a04]
    -->
    <para>
	 <function>pg_terminate_backend</function>を実行した時にコネクションのカウントがずれる不具合を修正しました。(Takuma Hoshiai)
    </para>
   </listitem>

   <listitem>
    <!--
    2020-06-04 [6474b3f]
    -->
    <para>
     アプリケーション名が<xref linkend="GUC-LOG-LINE-PREFIX">に含まれている場合に発生するセグメンテーション違反を修正しました。 (<ulink url="https://www.pgpool.net/mantisbt/view.php?id=615">bug 615</ulink>) (Tatsuo Ishii)
    </para>
   </listitem>

   <listitem>
    <!--
    2020-06-02 [4799953]
    -->
    <para>
	 ネイティブレプリケーションモードで<function>pg_terminate_backend()</function>を実行すると、フェイルオーバを引き起こしてしまう不具合を修正しました。(Takuma Hoshiai)
    </para>
   </listitem>

   <listitem>
    <!--
    2020-05-27 [f31f781]
    -->
    <para>
     IBM Zハードウェアでの004.watchdogテストのクラッシュを修正しました。 (<ulink url="https://www.pgpool.net/mantisbt/view.php?id=614">bug 614</ulink>) (Tatsuo Ishii)
    </para>
    <para>
	 パッチはgregn123により作成され、Tatsuo Ishiiにより修正されました。
    </para>
   </listitem>
  </itemizedlist>
 </sect2>
</sect1>

<sect1 id=release-4-0-9> 
 <!--
 <title>Release 4.0.9</title>
 -->
 <title>リリース 4.0.9</title>
 <note>
  <!--
  <title>Release Date</title>
  -->
  <title>リリース日</title>
  <simpara>2020-05-21</simpara>
 </note>

 <sect2>
  <!--
  <title>Bug fixes</title>
  -->
  <title>不具合修正</title>
  <itemizedlist>
   <listitem>
    <!--
    2020-05-16 [2fd983b]
    2020-04-26 [1304dcc]
    -->
    <para>
     <!--
     Fix build error on some system (Fedora 32). (Tatsuo Ishii)
     -->
     一部のシステム(Fedora 32)で発生するビルドエラーを修正しました。(Tatsuo Ishii)
    </para>
   </listitem>

   <listitem>
    <!--
    2020-05-06 [7c13a60]
    -->
    <para>
     <!--
     Fix pgpool ssl front end accept all ciphers. (<ulink url="https://www.pgpool.net/mantisbt/view.php?id=608">bug 608</ulink>) (Muhammad Usama)
     -->
     <productname>Pgpool-II</productname>がすべての暗号方式を受け付ける不具合を修正しました。(<ulink url="https://www.pgpool.net/mantisbt/view.php?id=608">bug 608</ulink>) (Muhammad Usama)
    </para>
   </listitem>

   <listitem>
    <!--
    2020-04-26 [311cdc7]
    -->
    <para>
     <!--
     Downgrade too verbose authentication logs. (Tatsuo Ishii)
     -->
     認証の詳細ログをダウングレードしました。(Tatsuo Ishii)
    </para>
   </listitem>

   <listitem>
    <!--
    2020-04-23 [1221a65]
    -->
    <para>
     <!--
     Fix unnecessary checks. (Tatsuo Ishii)
     -->
     不要なチェックを削除しました。(Tatsuo Ishii)
    </para>
    <para>
     <!--
     Patch contributed by sherlockcpp. Discussion: <ulink url="https://www.pgpool.net/pipermail/pgpool-general/2020-April/007062.html">[pgpool-general: 7004]</ulink>
     -->
     パッチはsherlockcppによって提供されました。Discussion: <ulink url="https://www.pgpool.net/pipermail/pgpool-general/2020-April/007062.html">[pgpool-general: 7004]</ulink>
    </para>
   </listitem>

   <listitem>
    <!--
    2020-04-23 [8ea84b9]
    -->
    <para>
     <!--
     Doc: Fix typo. (Tatsuo Ishii)
     -->
     Doc: ドキュメントのタイポを修正しました。(Tatsuo Ishii)
    </para>
    <para>
     <!--
     Patch contributed by Umar Hayat. 
     -->
     パッチはUmar Hayatによって提供されました。
     Discussion: <ulink url="https://www.pgpool.net/pipermail/pgpool-hackers/2020-April/003587.html">[pgpool-hackers: 3587]</ulink>
    </para>
   </listitem>

   <listitem>
    <!--
    2020-04-16 [75432c0]
    -->
    <para>
     <!--
     Fix for segmentation fault in PCP process. (<ulink url="https://www.pgpool.net/mantisbt/view.php?id=598">bug 598</ulink>) (Muhammad Usama)
     -->
     PCP プロセスのセグメンテーション違反を修正しました。(<ulink url="https://www.pgpool.net/mantisbt/view.php?id=598">bug 598</ulink>) (Muhammad Usama)
    </para>
   </listitem>

   <listitem>
    <!--
    2020-04-15 [595a3ec]
    -->
    <para>
     <!--
     Fix a warning message is never output in watchdog. (Tatsuo Ishii)
     -->
     Watchdogで一部の警告メッセージが出力されない問題を修正しました。(Tatsuo Ishii)
    </para>
    <para>
     <!--
     Patch provided by sherlockcpp. 
     -->
     パッチはsherlockcppによって提供されました。
     Discussion: (<ulink url="https://www.pgpool.net/pipermail/pgpool-general/2020-April/007014.html">[pgpool-general: 6956]</ulink>
    </para>
   </listitem>

   <listitem>
    <!--
    2020-04-12 [237793e]
    2020-04-06 [225290a]
    -->
    <para>
     <!--
     Doc: Fix typo. (Tatsuo Ishii, Bo Peng)
     -->
     Doc: タイポを修正しました。(Tatsuo Ishii, Bo Peng)
    </para>
    <para>
     <!--
     Patch provided by sherlockcpp.
     -->
     パッチはsherlockcppによって提供されました。
    </para>
   </listitem>

   <listitem>
    <!--
    2020-03-31 [9151b53]
    -->
    <para>
     <!--
     Fix <productname>Pgpool-II</productname> hangs when an Execute message is issued right after Sync message and query cache hits. (Tatsuo Ishii)
     -->
     Syncメッセージの直後にExecuteメッセージが発行され、クエリキャッシュがヒットすると、<productname>Pgpool-II</productname>がハングアップする不具合を修正しました。(Tatsuo Ishii)
    </para>
   </listitem>

   <listitem>
    <!--
    2020-03-13 [a558287]
    -->
    <para>
     <!--
     Fix problems in watchdog source code processing json data. (<ulink url="https://www.pgpool.net/mantisbt/view.php?id=596">bug 596</ulink>) (Tatsuo Ishii)
     -->
     Watchdogのソースコードの不適切なJSONデータの処理を修正しました。(<ulink url="https://www.pgpool.net/mantisbt/view.php?id=596">bug 596</ulink>) (Tatsuo Ishii)
    </para>
    <para>
     <!--
     Patch is provided by Greg Nancarrow (Fujitsu Australia).
     -->
     パッチはGreg Nancarrow (Fujitsu Australia)によって提供されました。
    </para>
   </listitem>

   <listitem>
    <!--
    2020-03-12 [0c1649e]
    -->
    <para>
     <!--
     Fix <literal>SCRAM</literal> auth handling bug. (<ulink url="https://www.pgpool.net/mantisbt/view.php?id=596">bug 596</ulink>) (Tatsuo Ishii)
     -->
     <literal>SCRAM</literal>認証処理の不具合を修正しました。(<ulink url="https://www.pgpool.net/mantisbt/view.php?id=596">bug 596</ulink>) (Tatsuo Ishii)
    </para>
    <para>
     <!--
     Patch is provided by Greg Nancarrow (Fujitsu Australia).
     -->
     パッチはGreg Nancarrow (Fujitsu Australia)によって提供されました。
    </para>
   </listitem>

   <listitem>
    <!--
    2020-03-11 [a639141]
    -->
    <para>
     <!--
     Fix possible data inconsistency in native replication mode. (Tatsuo Ishii)
     -->
     ネイティブレプリケーションモードで起こりうるデータの不整合を修正しました。(Tatsuo Ishii)
    </para>
    <para>
     Discussions:
     <ulink url="https://www.pgpool.net/pipermail/pgpool-general/2020-March/006954.html">[pgpool-general: 6896]</ulink>
     <ulink url="https://www.pgpool.net/pipermail/pgpool-hackers/2020-March/003540.html">[pgpool-hackers: 3540]</ulink>
    </para>
   </listitem>

   <listitem>
    <!--
    2020-03-06 [5ce6273]
    -->
    <para>
     <!--
     Fix watchdog ping probes fail with long hostnames due to small buffer. (<ulink url="https://www.pgpool.net/mantisbt/view.php?id=516">bug 516</ulink>) (Bo Peng)
     -->
     ホスト名が長い場合、バッファサイズの制限によってWatchdogのpingが失敗する問題を修正しました。(<ulink url="https://www.pgpool.net/mantisbt/view.php?id=516">bug 516</ulink>) (Bo Peng)
    </para>
   </listitem>

   <listitem>
    <!--
    2020-02-26 [99abd2e]
    -->
    <para>
     <!--
     Fix "last status change" timestamp is not set properly. (Tatsuo Ishii)
     -->
     「last status change」のタイムスタンプが正しく表示されない不具合を修正しました。(Tatsuo Ishii)
    </para>
   </listitem>
  </itemizedlist>
 </sect2>
</sect1>

<sect1 id=release-4-0-8> 
 <!--
 <title>Release 4.0.8</title>
 -->
 <title>リリース 4.0.8</title>
 <note>
  <!--
  <title>Release Date</title>
  -->
  <title>リリース日</title>
  <simpara>2020-02-20</simpara>
 </note>

 <sect2>
  <!--
  <title>Changes</title>
  -->
  <title>変更点</title>
  <itemizedlist>
   <listitem>
    <!--
    2020-02-18 [e9309ba]
    -->
    <para>
     <!--
     Disallowing the quorum aware failover option for the native replication mode. (Muhammad Usama)
     -->
     ネイティブレプリケーションモードの場合に、クォーラム合意によるフェールオーバ機能を無効にしました。(Muhammad Usama)
    </para>
    <para>
     <!--
     In native replication mode, Pgpool-II is responsible for replicating the data
     on all backend nodes, and if a node becomes quarantined then Pgpool-II stops
     sending the writes to that node. This is dangerous since it can cause data inconsistency.
     -->
     ネイティブレプリケーションモードで、<productname>Pgpool-II</productname>
     はすべてのバックエンドノードでデータをレプリケーションする役割を果たしています。
     ノードが<literal>quarantine</literal>(隔離)状態になると、<productname>Pgpool-II</productname>
     はそのノードへの書き込みを停止するので、データの不整合を引き起こす可能性があります。
    </para>
    <para>
     <!--
     So as per the discussion, we reached the conclusion to disallow failover require
     consensus and quorum existence with the native replication mode so that backend
     node should never get into quarantine when Pgpool-II is configured in the replication mode.
     -->
     そのため、レプリケーションモードの場合に、バックエンドノードが<literal>quarantine</literal>(隔離)状態にならないように、
     <xref linkend="GUC-FAILOVER-WHEN-QUORUM-EXISTS">と<xref linkend="GUC-FAILOVER-REQUIRE-CONSENSUS">機能を無効にしました。
    </para>
   </listitem>
   <listitem>
    <!--
    2020-01-28 [304e091]
    -->
    <para>
     <!--
     Check if socket file exists at startup and remove them if PID file doesn't exist to avoid bind() failire. (Bo Peng)
     -->
     起動時のbind()エラーを回避するために、ソケットファイルが存在するかどうかを確認し、
     PIDファイルが存在しない場合、それらのソケットファイルを削除するように修正しました。(Bo Peng)
    </para>
   </listitem>
  </itemizedlist>
 </sect2>

 <sect2>
  <!--
  <title>Bug fixes</title>
  -->
  <title>不具合修正</title>
  <itemizedlist>
   <listitem>
    <!--
    2020-02-18 [3889f69]
    -->
    <para>
     <!--
     Fix rewriting query errors in native replication mode. 
     (<ulink url="https://www.pgpool.net/mantisbt/view.php?id=551">bug 551</ulink>) (Bo Peng)
     -->
     レプリケーションモードの場合に、クエリのタイムスタンプがリライトされない不具合を修正しました。
     (<ulink url="https://www.pgpool.net/mantisbt/view.php?id=551">bug 551</ulink>) (Bo Peng)
    </para>
   </listitem>
   <listitem>
    <!--
    2020-02-18 [47fc7fc]
    2020-02-17 [4dc2ec3]
    2020-02-12 [1581295]
    2020-02-04 [d4f37bb]
    2020-02-04 [3ca4924]
    2020-01-28 [6d5eda7]
    2020-01-13 [ee7e42c]
    2020-01-12 [d213f2a]
    -->
    <para>
     <!--
     Doc: Update documentation and fix documentation typos. (Takuma Hoshiai, Tatsuo Ishii, Bo Peng)
     -->
     Doc: ドキュメントの更新、タイポの修正を行いました。(Takuma Hoshiai, Tatsuo Ishii, Bo Peng)
    </para>
   </listitem>
   <listitem>
    <!--
    2020-02-12 [21d620d]
    -->
    <para>
     <!--
     Fix child process segfault after reload if "health_check_database" is empty.
     (<ulink url="https://www.pgpool.net/mantisbt/view.php?id=571">bug 571</ulink>) (Bo Peng)
     -->
     <xref linkend="GUC-HEALTH-CHECK-DATABASE">が空の場合、リロード後に発生する子プロセスのセグメンテーション違反を修正しました。
     (<ulink url="https://www.pgpool.net/mantisbt/view.php?id=571">bug 571</ulink>) (Bo Peng)
    </para>
   </listitem>
   <listitem>
    <!--
    2020-02-08 [ade4f22]
    -->
    <para>
     <!--
     Fix <xref linkend="PGPOOL-SETUP"> to support <productname>PostgreSQL</productname> 12. (Tatsuo Ishii)
     -->
     <xref linkend="PGPOOL-SETUP">が<productname>PostgreSQL</productname> 12 に対応するように修正しました。(Tatsuo Ishii)
    </para>
   </listitem>
   <listitem>
    <!--
    2020-01-28 [f8bbd91]
    -->
    <para>
     <!--
     Doc: Change the sample follow_master_command script %M %H paramater's order. (Bo Peng)
     -->
     Doc: follow_master_command サンプルスクリプトの %M と %H パラメータの順序を変更しました。(Bo Peng)
    </para>
   </listitem>
   <listitem>
    <!--
    2020-01-19 [6b8ba75]
    2020-01-11 [ce2f63b]
    2020-01-10 [0462350]
    2020-01-04 [9ec04f0]
    2019-12-31 [3818be6]
    2019-12-26 [6b19fbb]
    2019-12-24 [e402ba9]
    -->
    <para>
     <!--
     Fix occasional regression test failure. (Tatsuo Ishii)
     -->
     時々起こるリグレッションテストの失敗を修正しました。(Tatsuo Ishii)
    </para>
   </listitem>
   <listitem>
    <!--
    2019-12-12 [5611c0e]
    -->
    <para>
     <!--
     Fix replication delay worker segfault when application_name in primary_conninfo is an empty string.
     (<ulink url="https://www.pgpool.net/mantisbt/view.php?id=565">bug 565</ulink>) (Tatsuo Ishii)
     -->
     primary_conninfoのapplication_nameが空の場合に発生するレプリケーション遅延チェックワーカープロセスのセグメンテーション違反を修正しました。
     (<ulink url="https://www.pgpool.net/mantisbt/view.php?id=565">bug 565</ulink>) (Tatsuo Ishii)
    </para>
   </listitem>
   <listitem>
    <!--
    2019-12-03 [ba4f142]
    -->
    <para>
     <!--
     Fix <xref linkend="SQL-PGPOOL-SHOW"> command doesn't display <literal>ALWAYS_MASTER</literal>,
     when <xref linkend="GUC-BACKEND-FLAG"> = 'ALWAYS_MASTER'. (Takuma Hoshiai)
     -->
     <xref linkend="GUC-BACKEND-FLAG"> = 'ALWAYS_MASTER'の場合に、<xref linkend="SQL-PGPOOL-SHOW">コマンドの出力に <literal>ALWAYS_MASTER</literal>が表示されない不具合を修正しました。(Takuma Hoshiai)
    </para>
   </listitem>
   <listitem>
    <!--
    2019-11-18 [0ef0d13]
    2019-11-15 [604ff2f]
    -->
    <para>
     <!--
     Fix the bug with ignored syslog setting. (Bo Peng)
     -->
     <literal>syslog</literal>が出力されない不具合を修正しました。(Bo Peng)
    </para>
   </listitem>
  </itemizedlist>
 </sect2>
</sect1>

<sect1 id=release-4-0-7> 
 <!--
 <title>Release 4.0.7</title>
 -->
 <title>リリース 4.0.7</title>
 <note>
  <!--
  <title>Release Date</title>
  -->
  <title>リリース日</title>
  <simpara>2019-10-31</simpara>
 </note>

 <sect2>
  <!--
  <title>Bug fixes</title>
  -->
  <title>不具合修正</title>
  <itemizedlist>
   <listitem>
    <!--
    2019-10-25 [45a3469]
    -->
    <para>
     <!--
     Fix incorrect query rewrite in replication mode. (Bo Peng)
     -->
	 レプリケーションモードでの誤ったクエリの書き換えを修正しました。 (Bo Peng)
    </para>
   </listitem>

   <listitem>
    <!--
    2019-10-21 [1d87df7]
    -->
    <para>
    <!--
	 Fix that health check timeout does work in certain case. (Tatsuo Ishii)
     -->
	 特定の場合にヘルスチェックのタイムアウトが正しく動作しない不具合を修正しました。(Tatsuo Ishii)
    </para>
    <para>
     Discussion: <ulink url="https://www.pgpool.net/pipermail/pgpool-hackers/2019-October/003458.html">[pgpool-hackers: 3458]</ulink>, <ulink url="https://www.pgpool.net/pipermail/pgpool-hackers/2019-October/003459.html">[pgpool-hackers: 3459]</ulink> 
    </para>
   </listitem>

   <listitem>
    <!--
    2019-10-15 [339bd21]
    -->
    <para>
    <!--
	 Doc: add <xref linkend="guc-failover-command"> description when all standby nodes are down. (Takuma Hoshiai)
     -->
	 Doc: すべてのスタンバイノードがダウンした場合の<xref linkend="guc-failover-command">の説明を追加しました。(Takuma Hoshiai)
    </para>
   </listitem>

   <listitem>
    <!--
    2019-10-11 [32a9f5d]
    -->
    <para>
    <!--
     Doc: add note not to assign <productname>PostgreSQL</productname> servers to <xref linkend="guc-trusted-servers">. (Tatsuo Ishii)
     -->
	 Doc: <productname>PostgreSQL</productname>サーバを<xref linkend="guc-trusted-servers">に指定しないように注意事項を追加しました。(Tatsuo Ishii)
    </para>
   </listitem>

   <listitem>
    <!--
    2019-10-14 [30aed19]
    -->
    <para>
    <!--
     Fix for miscellaneous watchdog issues. (Muhammad Usama)
     -->
	 いくつかの<literal>Watchdog</literal>の問題を修正しました。(Muhammad Usama)
    </para>
    <para>
    <!--
	 The lost nodes reported by life-check are treated as hard failures even when the node 
	 is reachable from the watchdog core.
     -->
	 lifecheckで失敗したノードはWatchdogクラスタから接続可能であっても
	 障害として扱われるように変更しました。
    </para>
    <para>
     <!--
     In the case of network partitioning or partial life-check failure, 
	 the kicked out standby node was too aggressive in trying to connect 
	 to the master or become a master itself so that potentially put the 
	 unnecessary burden on the network and the cluster nodes.
	 Fix is to make the isolated node a bit calm and wait between trying to connect to 
	 master or become a master.
     -->
     ネットワークパーティショニングまたは部分的なlifecheckの失敗の場合、
     切り離されたスタンバイノードは、マスターに接続しようとしたり、
     マスターになろうとするのに積極的すぎたため、ネットワークとクラスターノードに不必要
     な負担をかける可能性がありました。
     この問題は、切り離されたノードがマスターに接続したりマスターになろうとするのを少し待機させることで修正されました。
    </para>
    <para>
     詳細:
     (<ulink url="https://www.pgpool.net/mantisbt/view.php?id=547">bug 547</ulink>)、
     <ulink url="http://www.sraoss.jp/pipermail/pgpool-general/2019-August/006730.html">[pgpool-general: 6672]</ulink>
    </para>
   </listitem>

   <listitem>
    <!--
    2019-10-10 [4b726df]
    -->
    <para>
    <!--
 	 Fix assorted ancient v2 protocol bugs. (Tatsuo Ishii)
     -->
     各種のv2プロトコルのバグを修正しました。(Tatsuo Ishii)
    </para>
   </listitem>

   <listitem>
    <!--
    2019-10-08 [45ac39b]
    -->
    <para>
    <!--
	 Fix problem that <xref linkend="guc-syslog-facility"> doesn't change by reload. 
     (<ulink url="https://www.pgpool.net/mantisbt/view.php?id=548">bug 548</ulink>) (Takuma Hoshiai)
     -->
     <xref linkend="guc-syslog-facility">の変更がリロードによって反映されない不具合を修正しました。
     (<ulink url="https://www.pgpool.net/mantisbt/view.php?id=548">bug 548</ulink>) (Takuma Hoshiai)
    </para>
   </listitem>

   <listitem>
    <!--
    2019-10-03 [fed3d6b]
    -->
    <para>
     <!--
     Fix Pgpool-II shutdown failed in certain case. (Tatsuo Ishii)
     -->
     特定の場合に<productname>Pgpool-II</productname>のシャットダウンが失敗する不具合を修正しました。(Tatsuo Ishii)
    </para>
   </listitem>

   <listitem>
    <!--
    2019-09-29 [94b96ed]
    -->
    <para>
    <!--
     Allow the lost standby node to rejoin the master watchdog node when it gets rediscovered by the lifecheck.
     (<ulink url="https://www.pgpool.net/mantisbt/view.php?id=545">bug 545</ulink>) (Muhammad Usama)
     -->
	 切り離されたスタンバイノードがlifecheckによって再発見されたときに、マスターウォッチドッグノードに再参加できるように修正しました。
     (<ulink url="https://www.pgpool.net/mantisbt/view.php?id=545">bug 545</ulink>) (Muhammad Usama)
    </para>
   </listitem>

   <listitem>
    <!--
    2019-08-06 [2d27189]
    -->
    <para>
     <!--
	 Overhaul health check debug facility. (Tatsuo Ishii)
     -->
	 ヘルスチェックのデバッグ機能を改善しました。(Tatsuo Ishii)
    </para>
   </listitem>

   <listitem>
    <!--
    2019-09-15 [a333a45]
    -->
    <para>
     <!--
     Fix segfault when executing an erroneous query after DEALLOCATE a named statement.
     (<ulink url="https://www.pgpool.net/mantisbt/view.php?id=546">bug 546</ulink>) (Tatsuo Ishii)
     -->
	 名前付きステートメントをDEALLOCATEした後に、誤ったクエリを実行すると
     セグメンテーション違反が発生する不具合を修正しました。
     (<ulink url="https://www.pgpool.net/mantisbt/view.php?id=546">bug 546</ulink>) (Tatsuo Ishii)
    </para>
   </listitem>

   <listitem>
    <!--
    2019-09-09 [7fcc9f3]
    -->
    <para>
     <!--
     Doc: clarify that certificate authentication works between only client and <productname>Pgpool-II</productname>. (Tatsuo Ishii)
     -->
	 Doc: クライアントと<productname>Pgpool-II</productname>の間でのみ証明書認証が機能する注意点をドキュメントに追加しました。(Tatsuo Ishii)
    </para>
   </listitem>

   <listitem>
    <!--
    2019-09-05 [fc5898c]
    -->
    <para>
     <!--
     Doc: update configuration Examples "Pgpool-II + Watchdog Setup Example". (Bo Peng)
     -->
	 Doc: 設定の例「Pgpool-II + Watchdogの構築の例」を更新しました。(Bo Peng)
    </para>
   </listitem>

   <listitem>
    <!--
    2019-09-04 [3ba4e73]
    -->
    <para>
     <!--
     Doc: mention that VIP will not be brougt up if quorum does not exist. (Tatsuo Ishii)
     -->
	 Doc: クォーラムが存在しない場合、VIPは起動されないことをドキュメントに追加しました。(Tatsuo Ishii)
    </para>
   </listitem>

   <listitem>
    <!--
    2019-08-28 [e11ef8c]
    -->
    <para>
     <!--
     Fix <command>pgpool_setup</command> to deal with <productname>PostgreSQL</productname> 9.1. (Tatsuo Ishii)
     -->
	 <productname>PostgreSQL</productname> 9.1 に対応するために、<command>pgpool_setup</command>を修正しました。(Tatsuo Ishii)
    </para>
   </listitem>

   <listitem>
    <!--
    2019-08-18 [94428ea]
    -->
    <para>
     <!--
  	 Fix for password authentication does not work when the password for 
	 the connecting user is not found in the pool_passwd file.
     (<ulink url="https://www.pgpool.net/mantisbt/view.php?id=534">bug 534</ulink>) (Muhammad Usama)
     -->
	 接続ユーザーのパスワードがpool_passwdファイルに見つからない場合、password認証が正しく動作しない不具合を修正しました。
     (<ulink url="https://www.pgpool.net/mantisbt/view.php?id=534">bug 534</ulink>) (Muhammad Usama)
    </para>
   </listitem>

   <listitem>
    <!--
    2019-08-16 [956c040]
    -->
    <para>
     <!--
     Add "-I" option to <xref linkend="guc-arping-cmd"> command default setting. (Bo Peng)
     -->
	 <xref linkend="guc-arping-cmd">パラメータのデフォルト値にネットワークインターフェイスオプション -I を含めるように修正しました。(Bo Peng)
    </para>
   </listitem>
  </itemizedlist>
 </sect2>
</sect1>

<sect1 id=release-4-0-6> 
 <!--
 <title>Release 4.0.6</title>
 -->
 <title>リリース 4.0.6</title>
 <note>
  <!--
  <title>Release Date</title>
  -->
  <title>リリース日</title>
  <simpara>2019-08-15</simpara>
 </note>

 <sect2>
  <!--
  <title>Enhancements</title>
  -->
  <title>改善点</title>
  <itemizedlist>
   <listitem>
    <!--
    2019-08-15 [0a94393]
    -->
    <para>
     <!--
     Doc: Update "Pgpool-II + Watchdog Setup Example" to support <productname>PostgreSQL 12</productname>. (Bo Peng)
     -->
     Doc: "Pgpool-II + Watchdog Setup Example"が<productname>PostgreSQL</productname> 12に対応するように修正しました。(Bo Peng)
    </para>
   </listitem>
   <listitem>
    <!--
    2019-08-08 [7ea54a1]
    -->
    <para>
     <!--
     Import some of memory manager debug facilities from <productname>PostgreSQL</productname>. (Tatsuo Ishii)
     -->
     <productname>PostgreSQL</productname>からメモリマネージャデバッグ機能の一部をインポートしました。(Tatsuo Ishii)
    </para>
   </listitem>
   <listitem>
    <!--
    2019-07-24 [717411f]
    -->
    <para>
     <!--
     Use <function>pg_get_expr()</function> instead of <literal>pg_attrdef.adsrc</literal> to support for <productname>PostgreSQL</productname> 12. (Bo Peng)
     -->
     <productname>PostgreSQL</productname> 12に対応するために、<literal>pg_attrdef.adsrc</literal>のかわりに
     <function>pg_get_expr()</function>を使用するように修正しました。(Bo Peng)
    </para>
   </listitem>
   <listitem>
    <!--
    2019-08-11 [c553e51]
    2019-07-17 [6b89f9e]
    2019-07-02 [3b32bc4]
    -->
    <para>
     <!--
     Enhance shutdown script of <xref linkend="PGPOOL-SETUP">. (Tatsuo Ishii)
     -->
     <xref linkend="PGPOOL-SETUP">のshutdownスクリプトを改良しました。(Tatsuo Ishii)
      <itemizedlist> 
       <listitem>
	<para>
	 <!--
	 Make shutdownall to wait for completion of shutdown of <productname>Pgpool-II</productname>.
	 -->
	 shutdownスクリプトが<productname>Pgpool-II</productname>のシャットダウン完了を待つように修正しました。
	</para>
       </listitem>
       <listitem>
	<para>
	 <!--
	 if environment variable <varname>CHECK_TIME_WAIT</varname> is set to true, use <command>netstat</command> command to confirm usage of the <literal>TCP/IP</literal> port while executing shutdown script.
	 -->
	 環境変数<varname>CHECK_TIME_WAIT</varname>が<literal>true</literal>に設定されているとき、shutdownスクリプト実行時に<command>netstat</command>コマンドで<literal>TCP/IP</literal>ポートの使用を確認するように修正しました。 
	</para>
       </listitem>
      </itemizedlist> 
    </para>
   </listitem>

   <listitem>
    <!--
    2019-05-22 [57cd1d4]
    -->
    <para>
     <!--
     Deal <literal>pgpool_adm</literal> extension with <productname>PostgreSQL</productname> 12. (Tatsuo Ishii)
     -->
     <literal>pgpool_adm</literal>拡張が<productname>PostgreSQL</productname> 12 に対応するように修正しました。(Tatsuo Ishii)
    </para>
   </listitem>

   <listitem>
    <!--
    2019-06-02 [08c0bfa]
    -->
    <para>
     <!--
     Doc: add description to <xref linkend="PG-MD5"> man page how to show <filename>pool_passwd</filename> hashed string. (Tatsuo Ishii)
     -->
     Doc: <xref linkend="PG-MD5">のドキュメントに<filename>pool_passwd</filename>ハッシュ文字列を表示させる方法を追加しました。(Tatsuo Ishii)
    </para>
   </listitem>

   <listitem>
    <!--
    2019-05-26 [a899be1]
    -->
    <para>
     <!--
     Doc: add general description about failover. (Tatsuo Ishii)
     -->
     Doc: フェイルオーバに関する一般的な説明を追加しました。(Tatsuo Ishii)
    </para>
   </listitem>
  </itemizedlist>
 </sect2>

 <sect2>
  <!--
  <title>Bug fixes</title>
  -->
  <title>不具合修正</title>

  <itemizedlist>
   <listitem>
    <!--
    2019-08-11 [fd53304]
    2019-08-11 [8653c40]
    -->
    <para>
     <!--
     Test: Fix test failure of extended-query-test when <varname>disable_load_balance_on_write = off/transaction/always</varname>. (Tatsuo Ishii)
     -->
     Test: <varname>disable_load_balance_on_write = off/transaction/always</varname>の場合に拡張問い合わせテストが失敗するのを修正しました。(Tatsuo Ishii)
    </para>
   </listitem>

   <listitem>
    <!--
    2019-08-09 [b6d77f4]
    -->
    <para>
     <!--
     Fix "unable to bind. cannot get parse message" error.
     (<ulink url="https://www.pgpool.net/mantisbt/view.php?id=531">bug 531</ulink>) (Tatsuo Ishii)
     -->
     "unable to bind. cannot get parse message"エラーを修正しました。
     (<ulink url="https://www.pgpool.net/mantisbt/view.php?id=531">bug 531</ulink>) (Tatsuo Ishii)
    </para>
   </listitem>

   <listitem>
    <!--
    2019-08-08 [f48f624]
    -->
    <para>
     <!--
     Fix online-recovery is blocked after a child process exits abnormally with replication mode and watchdog. 
     (<ulink url="https://www.pgpool.net/mantisbt/view.php?id=483">bug 483</ulink>) (Muhammad Usama)
     -->
     ネイティブレプリケーションモードかつ<application>Watchdog</application>が有効な場合、
     子プロセスが異常終了した後に、オンラインリカバリが失敗する不具合を修正しました。
     (<ulink url="https://www.pgpool.net/mantisbt/view.php?id=483">bug 483</ulink>) (Muhammad Usama)
    </para>
   </listitem>

   <listitem>
    <!--
    2019-05-16 [0dbf6eb]
    -->
    <para>
     <!--
     Fix for keep the backend health check running on quarantined nodes. (Muhammad Usama)
     -->
     隔離(quarantine)されたバックエンドに対してヘルスチェックを続けるように修正しました。(Muhammad Usama)
    </para>
    <para>
     <!--
     Pgpool should keep the backend health check running on quarantined nodes so
     that when the connectivity resumes, they should automatically get removed
     from the quarantine. 
     -->
     隔離されたバックエンドが接続再開されたときに自動的に隔離状態から解消されるように、
     <productname>Pgpool-II</productname>が隔離されたバックエンドに対してヘルスチェックを実行し続ける必要があります。
    </para>
    <para>
     <!--
     See <ulink url="https://www.pgpool.net/pipermail/pgpool-hackers/2019-April/003295.html">[pgpool-hackers: 3295]</ulink> for more details. 
     -->
     詳細は<ulink url="https://www.pgpool.net/pipermail/pgpool-hackers/2019-April/003295.html">[pgpool-hackers: 3295]</ulink>をご参照ください。
    </para>
   </listitem>

   <listitem>
    <!--
    2019-08-07 [29dab7b]
    -->
    <para>
     <!--
     Fix for no primary on standby pgpool when primary is quarantined on master. (Muhammad Usama)
     -->
     マスター<productname>Pgpool-II</productname>でプライマリが隔離 (quarantine) されている場合、
     スタンバイ<productname>Pgpool-II</productname>でプライマリノードが存在しない状態を修正しました。(Muhammad Usama)
    </para>
    <para>
     <!--
     Master watchdog Pgpool sends the backend status sync message if the primary node is quarantined on it.
     So standby watchdog pgpool must not update its status when the status of current primary node
     is not DOWN.
     -->
     プライマリノードが隔離 (quarantine) されている場合、マスター<productname>Pgpool-II</productname>は、
     プライマリノードステータスの同期メッセージを送信します。
     スタンバイ<productname>Pgpool-II</productname>では現在のプライマリノードのステータスがDOWNでない場合、
     プライマリノードのステータスを更新しないように修正しました。
    </para>
   </listitem>

   <listitem>
    <!--
    2019-07-29 [d2aa09a]
    -->
    <para>
     <!--
     Fix <xref linkend="WATCHDOG-SETUP"> command <literal>mode</literal> option to work correctly. (Takuma Hoshiai)
     -->
     <xref linkend="WATCHDOG-SETUP">コマンドの<literal>mode</literal>オプションが正しく動作するように修正しました。(Takuma Hoshiai)
    </para>
   </listitem>

   <listitem>
    <!--
    2019-07-28 [34dc12f]
    -->
    <para>
     <!--
     Fix <xref linkend="PGPOOL-SETUP"> to produce correct follow master command. (Tatsuo Ishii)
     -->
     <xref linkend="PGPOOL-SETUP">が正しい<varname>follow master command</varname>を生成するように修正しました。(Tatsuo Ishii)
    </para>
   </listitem>

   <listitem>
    <!--
    2019-07-10 [801d8a8]
    -->
    <para>
     <!--
     Fix in native replication mode <productname>Pgpool-II</productname> rewriting query error when the queries include
     <literal>GROUPS</literal> and <literal>EXCLUDE</literal> in <literal>frame</literal> clauses. (Bo Peng)
     -->
     ネイティブレプリケーションモードで、クエリの<literal>frame</literal>句に<literal>GROUPS</literal>と<literal>EXCLUDE</literal>が含まれている場合、
     <productname>Pgpool-II</productname>がクエリを正しく書き換えられない不具合を修正しました。(Bo Peng)
    </para>
   </listitem>

   <listitem>
    <!--
    2019-07-07 [44f8e2d]
    -->
    <para>
     <!--
     Fix query cache module so that it checks oid array's bound. (Tatsuo Ishii)
     -->
     クエリキャッシュモジュールでoid配列の境界をチェックするように修正しました。(Tatsuo Ishii)
    </para>
   </listitem>

   <listitem>
    <!--
    2019-07-07 [bb3af6f]
    -->
    <para>
     <!--
     Fix off-by-one error in query cache module. (Tatsuo Ishii)
     -->
     クエリキャッシュモジュールのOff-by-oneエラーを修正しました。(Tatsuo Ishii)
    </para>
   </listitem>

   <listitem>
    <!--
    2019-07-05 [27c2476]
    -->
    <para>
     <!--
     Allow health check process to reload. (Tatsuo Ishii)
     -->
     ヘルスチェックプロセスで<filename>pgpool.conf</filename>がリロードされない不具合を修正しました。(Tatsuo Ishii)
    </para>
   </listitem>

   <listitem>
    <!--
    2019-07-03 [5d042e4]
    -->
    <para>
     <!--
     Fix sefault when query cache is enabled. (<ulink url="https://www.pgpool.net/mantisbt/view.php?id=525">bug 525</ulink>) (Tatsuo Ishii)
     -->
     クエリキャッシュが有効な場合に発生するセグメンテーション違反を修正しました。(<ulink url="https://www.pgpool.net/mantisbt/view.php?id=525">bug 525</ulink>) (Tatsuo Ishii)
    </para>
   </listitem>

   <listitem>
    <!--
    2019-07-02 [b8137d6]
    -->
    <para>
     <!--
     Down grade LOG "checking zapping sent message ..." to DEBUG5. (Tatsuo Ishii)
     -->
     LOG "checking zapping sent message ..."をDEBUG5にダウングレードしました。(Tatsuo Ishii)
    </para>
    <para>
     <!--
     Discussion: <ulink url="https://www.pgpool.net/pipermail/pgpool-general/2019-June/006678.html">[pgpool-general: 6620]</ulink>
     -->
     詳細は<ulink url="https://www.pgpool.net/pipermail/pgpool-general/2019-June/006678.html">[pgpool-general: 6620]</ulink>をご参照ください。
    </para>
   </listitem>

   <listitem>
    <!--
    2019-06-24 [8742f9f]
    -->
    <para>
     <!--
     Fix segfault when <literal>samenet</literal> is specified in <filename>pool_hba.conf</filename>. (Tatsuo Ishii)
     -->
     <filename>pool_hba.conf</filename>に<literal>samenet</literal>が指定されている場合に発生するセグメンテーション違反を修正しました。(Tatsuo Ishii)
    </para>
    <para>
     <!--
     Discussion: <ulink url="https://www.pgpool.net/pipermail/pgpool-general/2019-June/006659.html">[pgpool-general: 6601]</ulink>.
     -->
     詳細は<ulink url="https://www.pgpool.net/pipermail/pgpool-general/2019-June/006659.html">[pgpool-general: 6601]</ulink>をご参照ください。
    </para>
   </listitem>

   <listitem>
    <!--
    2019-06-20 [4277e9b]
    2019-06-19 [f87890b]
    2019-06-19 [8af9198]
    -->
    <para>
     <!--
     Doc: Fix documentation mistakes in <filename>follow_master.sh</filename> script and typos. (Bo Peng)
     -->
     Doc: 「7.3. Pgpool-II + Watchdogの構築の例」の<filename>follow_master.sh</filename>スクリプトの間違いとタイポを修正しました。(Bo Peng)
    </para>
   </listitem>

   <listitem>
    <!--
    2019-06-11 [361f4ec]
    -->
    <para>
     <!--
     Fix health check process is not shutting down in certain cases. (Tatsuo Ishii)
     -->
     特定のケースでヘルスチェックプロセスが終了しない問題を修正しました。(Tatsuo Ishii)
    </para>
   </listitem>

   <listitem>
    <!--
    2019-06-07 [48a45fc]
    -->
    <para>
     <!--
     Fix to deal with backslashes according to the config of <varname>standard_conforming_strings</varname> in native replication mode.
     -->
     ネイティブレプリケーションモードの場合、<varname>standard_conforming_strings</varname>の設定に応じてバックスラッシュを処理するように修正しました。
     (<ulink url="https://www.pgpool.net/mantisbt/view.php?id=467">bug 467</ulink>) (Bo Peng)
    </para>
   </listitem>

   <listitem>
    <!--
    2019-05-23 [81b9c11]
    -->
    <para>
     <!--
     Fix compile error on FreeBSD.
     (<ulink url="https://www.pgpool.net/mantisbt/view.php?id=512">bug 512</ulink>,
     <ulink url="https://www.pgpool.net/mantisbt/view.php?id=519">bug 519</ulink>) (Bo Peng)
     --> 
     FreeBSD上で発生するコンパイルエラーを修正しました。
     (<ulink url="https://www.pgpool.net/mantisbt/view.php?id=512">bug 512</ulink>,
     <ulink url="https://www.pgpool.net/mantisbt/view.php?id=519">bug 519</ulink>) (Bo Peng)
    </para>
   </listitem>

   <listitem>
    <!--
    2018-08-14 [5765ed7]
    2019-05-23 [0e8c1c2]
    2019-05-22 [c264275]
    2019-05-22 [53e7af0]
    2019-05-22 [19cfda2]
    -->
    <para>
     <!--
     Fix memory leaks. (Tatsuo Ishii)
     -->
     いくつかのメモリリークを修正しました。(Tatsuo Ishii)
    </para>
   </listitem>

   <listitem>
    <!--
    2019-05-23 [827a056]
    -->
    <para>
     <!--
     Make failover in progress check more aggressively to avoid potential segfault. (Tatsuo Ishii)
     -->
     潜在的なセグメンテーション違反を回避するために、フェイルオーバ実行中であるかどうかのチェックをより積極的に行うように修正しました。(Tatsuo Ishii)
    </para>
   </listitem>
  </itemizedlist>
 </sect2>
</sect1>

<sect1 id=release-4-0-5> 
 <!--
 <title>Release 4.0.5</title>
 -->
 <title>リリース 4.0.5</title>
 <note>
  <!--
  <title>Release Date</title>
  -->
  <title>リリース日</title>
  <simpara>2019-05-16</simpara>
 </note>

 <sect2>
  <!--
  <title>Enhancements</title>
  -->
  <title>改善点</title>
  <itemizedlist>
   <listitem>
    <!--
    2019-05-04 [ad4323b]
    -->
    <para>
     <!--
     Doc: Improve <xref linkend="PCP-COMMANDS"> document. (Tatsuo Ishii)
     -->
     Doc: ドキュメント<link linkend="pcp-commands">リファレンスII, PCP コマンド</link>を改善しました。(Tatsuo Ishii)
    </para>
   </listitem>

   <listitem>
    <!--
    2019-05-03 [bd6757e]
    -->
    <para>
     <!--
     Speed up failover when all of backends are down. (Tatsuo Ishii)
     -->
     すべてのバックエンドが停止しているときのフェイルオーバをスピードアップします。(Tatsuo Ishii)
    </para>
    <para>
     <!--
     If all of the backend are in down status, immediately give up finding 
     primary node regardless <varname>search_primary_node_timeout</> and promptly 
     finish the failover process.
     -->
     すべてのバックエンドが停止状態になった場合、<varname>search_primary_node_timeout</>の値に関わらずプライマリノードの検索を中止し、
     直ちにフェールオーバプロセスを終了するように修正しました。
    </para>
    <para>
     <!--
     Discussion: <ulink url="https://www.pgpool.net/pipermail/pgpool-hackers/2019-May/003321.html">[pgpool-hackers: 3321]</ulink>
     -->
     ディスカッション: <ulink url="https://www.pgpool.net/pipermail/pgpool-hackers/2019-May/003321.html">[pgpool-hackers: 3321]</ulink>
    </para>
   </listitem>

   <listitem>
    <!--
    2019-04-30 [50d2d6a]
    2019-04-30 [bd43ca8]
    -->
    <para>
     <!--
     pgpool-recovery extension and <command>pgpool_setup</> is now ready for the next major release <productname>PostgreSQL</> 12. (Tatsuo Ishii)
     -->
     pgpool-recovery拡張と<command>pgpool_setup</>を次期バージョンである<productname>PostgreSQL</>12に対応しました。(Tatsuo Ishii)
    </para>
   </listitem>
   <listitem>
    <!--
    2019-04-10 [c845e30]
    2019-04-09 [5d2078b]
    -->
    <para>
     <!--
     Doc: add <xref linkend="RESTRICTIONS"> entry. (Takuma Hoshiai)
     -->
     Doc: ドキュメントの<xref linkend="RESTRICTIONS">の項目を追加しました。(Takuma Hoshiai)
    </para>
   </listitem>
  </itemizedlist>
 </sect2>

 <sect2>
  <!--
  <title>Bug fixes</title>
  -->
  <title>不具合修正</title>
  <itemizedlist>
   <listitem>
    <!--
    2019-05-09 [6e925e8]
    -->
    <para>
     <!--
     Fix the wrong error message "ERROR: connection cache is full", when all backend nodes are down. 
     (<ulink url="http://www.pgpool.net/mantisbt/view.php?id=487">bug 487</>) (Bo Peng)
     -->
     すべてのバックエンドがダウンした場合には表示される不適切なエラーメッセージ"ERROR: connection cache is full"を修正しました。
     (<ulink url="http://www.pgpool.net/mantisbt/view.php?id=487">bug 487</>) (Bo Peng)
    </para>
    <para>
     <!--
     When all backend nodes are down, <productname>Pgpool-II</> throws an uncorrect
     error message "ERROR: connection cache is full". Change the error
     message to "all backend nodes are down, pgpool requires at least one valid node".
     -->
     すべてのバックエンドがダウンした場合に、<productname>Pgpool-II</>が不適切なエラーメッセージ"ERROR: connection cache is full"を投げています。
     このエラーを"all backend nodes are down, pgpool requires at least one valid node"に修正しました。
    </para>
   </listitem>
   <listitem>
    <!--
    2019-04-24 [bb594b2]
    -->
    <para>
     <!--
     Remove unused .sgml file. (Takuma Hoshiai)
     -->
     使用されていない.sgmlファイルを削除しました。(Takuma Hoshiai)
    </para>
   </listitem>

   <listitem>
    <!--
    2019-04-21 [c670dbf]
    -->
    <para>
     <!--
     Avoid exit/fork storm of pool_worker_child process. (Tatsuo Ishii)
     -->
     pool_worker_childプロセスの終了/フォークの繰り返しを避けるために修正しました。(Tatsuo Ishii)
    </para>
    <para>
     <!--
     pool_worker_child issues query to get WAL position using <function>do_query()</>,
     which could throws FATAL error. In this case pool_worker_child process
     exits and <productname>Pgpool-II</> parent immediately forks new process. This cycle
     indefinitely repeats and gives high load to the system.
     To avoid the exit/fork storm, sleep <varname>sr_check_period</>.
     -->
     pool_worker_childは<function>do_query()</>を使用してWAL位置を取得するためのクエリを発行します。
     これにより、致命的エラーが発生した場合、pool_worker_childプロセスを終了し、
     <productname>Pgpool-II</>の親プロセスは直ちに新しいプロセスをフォークするようにしています。
     このサイクルは無限に繰り返され、システムに大きな負荷を与える可能性があります。
     無限に繰り返される終了/フォーク処理を回避するために、<varname>sr_check_period</>をスリープさせるように修正しました。
    </para>
   </listitem>

   <listitem>
    <!--
    2019-04-18 [9b1bb1f]
    -->
    <para>
     <!--
     Fix <xref linkend="GUC-WRITE-FUNCTION-LIST">'s broken default value. (Tatsuo Ishii)
     -->
     <xref linkend="GUC-WRITE-FUNCTION-LIST">のデフォル値が間違っていた不具合を修正しました。(Tatsuo Ishii)
    </para>
   </listitem>

   <listitem>
    <!--
    2019-04-17 [51131a2]
    -->
    <para>
     <!--
     Fix "not enough space in buffer" error. 
     (<ulink url="http://www.pgpool.net/mantisbt/view.php?id=499">bug 499</>) (Tatsuo Ishii)
     -->
     「not enough space in buffer」エラーを修正しました。
     (<ulink url="http://www.pgpool.net/mantisbt/view.php?id=499">bug 499</>) (Tatsuo Ishii)
    </para>
    <para>
     <!--
     The error occurred while processing error message returned from
     backend and the cause is that the query string in question is too
     big. Problem is, the buffer is in fixed size (8192 bytes).
     Eliminate the fixed size buffer and use palloced buffer
     instead. This also saves some memory copy work.
     -->
     バックエンドから返されたエラーメッセージサイズが固定バッファサイズ (8192 bytes)を超えた場合、
     「not enough space in buffer」エラーが発生していました。
     固定サイズのバッファの使用を廃止し、動的にバッファサイズを割り当てるように修正しました。
    </para>
   </listitem>

   <listitem>
    <!--
    2019-04-16 [e765df5]
    -->
    <para>
     <!--
     Fix DROP DATABASE failure. (Tatsuo Ishii)
     -->
     DROP DATABASEの失敗を修正しました。 (Tatsuo Ishii)
    </para>
   </listitem>

   <listitem>
    <!--
    2019-04-10 [89ad3d5]
    -->
    <para>
     <!--
     Fix wrong variable in <function>read_status_file()</> function. (Takuma Hoshiai)
     -->
     <function>read_status_file()</>関数の間違った変数名を修正しました。
     (<ulink url="http://www.pgpool.net/mantisbt/view.php?id=493">bug 493</>) (Takuma Hoshiai)
    </para>
   </listitem>

   <listitem>
    <!--
    2019-04-08 [7984154]
    -->
    <para>
     <!--
     Add missing <filename>test/watchdog_setup</> to EXTRA_DIST. (<ulink url="http://www.pgpool.net/mantisbt/view.php?id=470">bug 470</>) (Bo Peng)
     -->
     漏れていたtest/watchdog_setupをEXTRA_DISTに追加しました。(<ulink url="http://www.pgpool.net/mantisbt/view.php?id=470">bug 470</>) (Bo Peng)
    </para>
   </listitem>

   <listitem>
    <!--
    2019-04-07 [df4c94f]
    -->
    <para>
     <!--
     Doc: mention that multi-statement queries are sent to primary node only. (<ulink url="http://www.pgpool.net/mantisbt/view.php?id=492">bug 492</>) (Tatsuo Ishii)
     -->
     Doc: マルチステートメントクエリはプライマリノードにのみ送信されるという説明をドキュメントに追加しました。(<ulink url="http://www.pgpool.net/mantisbt/view.php?id=492">bug 492</>) (Tatsuo Ishii)
    </para>
   </listitem>

   <listitem>
    <!--
    2019-04-05 [8168c31]
    -->
    <para>
     <!--
     Fix md5 auth broken in raw mode with more than 1 backends. 
     (<ulink url="http://www.pgpool.net/mantisbt/view.php?id=491">bug 491</>) (Tatsuo Ishii)
     -->
     rawモードかつ複数のバックエンドが設定された場合に発生するmd5認証の失敗を修正しました。
     (<ulink url="http://www.pgpool.net/mantisbt/view.php?id=491">bug 491</>) (Tatsuo Ishii) 
    </para>
   </listitem>

   <listitem>
    <!--
    2019-04-03 [5cdc21f]
    -->
    <para>
     <!--
     Test: Fix occasional regression test failure of 014.watchdog_test_quorum_bypass. (Tatsuo Ishii)
     -->
     Test: 014.watchdog_test_quorum_bypass レグレッションテストの失敗を修正しました。(Tatsuo Ishii)
    </para>
   </listitem>

   <listitem>
    <!--
    2019-04-02 [816d508]
    -->
    <para>
     <!--
     Abort session if failover/failback is ongoing to prevent potential segfault. 
     (<ulink url="http://www.pgpool.net/mantisbt/view.php?id=481">bug 481</ulink>, 
     <ulink url="http://www.pgpool.net/mantisbt/view.php?id=482">bug 482</ulink>) (Tatsuo Ishii)
     -->
     failover/failback実行中に接続があった場合に発生しうるセグメンテーション違反を回避するために、セッションを終了するように修正しました。
     (<ulink url="http://www.pgpool.net/mantisbt/view.php?id=481">bug 481</ulink>, 
     <ulink url="http://www.pgpool.net/mantisbt/view.php?id=482">bug 482</ulink>) (Tatsuo Ishii)
    </para>
   </listitem>

   <listitem>
    <!--
    2019-03-30 [508f1c4]
    2019-03-30 [37162de]
    -->
    <para>
     <!--
     Fix compiler warnings. (Tatsuo Ishii)
     -->
     コンパイル時に発生するワーニング を修正しました。(Tatsuo Ishii)
    </para>
   </listitem>

   <listitem>
    <!--
    2019-03-28 [3688592]
    -->
    <para>
     <!--
     Fix memory leak in "batch" mode in extended query. 
     (<ulink url="http://www.pgpool.net/mantisbt/view.php?id=468">bug 468</>) (Tatsuo Ishii)
     -->
     拡張問い合わせかつ"batch"モードで発生するメモリリークを修正しました。
     (<ulink url="http://www.pgpool.net/mantisbt/view.php?id=468">bug 468</>) (Tatsuo Ishii)
    </para>
   </listitem>
  </itemizedlist>
 </sect2>
</sect1>

<sect1 id=release-4-0-4> 
 <!--
 <title>Release 4.0.4</title>
 -->
 <title>リリース 4.0.4</title>
 <note>
  <!--
  <title>Release Date</title>
  -->
  <title>リリース日</title>
  <simpara>2019-03-29</simpara>
 </note>

 <sect2>
  <!--
  <title>Enhancements</title>
  -->
  <title>改善点</title>
  <itemizedlist>
   <listitem>
    <!--
    2019-03-27 [03dfe9c]
    -->
    <para>
     <!--
     Add new configuration option <xref linkend="guc-ssl-prefer-server-ciphers">. (Muhammad Usama)
     -->
     新しい設定パラメータ<xref linkend="guc-ssl-prefer-server-ciphers">を追加しました。(Muhammad Usama)
    </para>
    <para>
     <!--
     Add the new setting <xref linkend="guc-ssl-prefer-server-ciphers"> to let users configure if they
     want client's or server's cipher order to take preference.
     -->
     ユーザがサーバ側のSSL暗号設定をクライアントに優先して使うかどうかを設定できるように、新しい設定パラメータ<xref linkend="guc-ssl-prefer-server-ciphers">を追加しました。
    </para>
    <para>
     <!--
     The default for this parameter is off, which prioritize the client's
     cipher order as usual. However this is just for keeping backward
     compatibility, and it is possible that a malicious client uses weak
     ciphers. For this reason we recommend to set this parameter to on at
     all times.
     -->
     この設定はデフォルトでオフで、従来と同じようにクライアント側のリクエストが優先されます。
     しかしこれはあくまで過去の挙動との互換性のための設定であり、悪意のあるクライアントが弱い暗号を利用できる可能性があります。
     ですから、常にこのパラメータをオンにしておくことを推奨します。
    </para>
   </listitem>

   <listitem>
    <!--
    2019-03-27 [ab63263]
    2019-03-23 [ec9c44c]
    -->
    <para>
     <!--
     Allow to set a client cipher list. (Tatsuo Ishii, Yugo Nagata)
     -->
     client cipher リストの設定が可能になりました。(Tatsuo Ishii, Yugo Nagata)  
    </para>
    <para>
     <!--
     For this purpose new parameter <xref linkend="guc-ssl-ciphers">, which specifies the cipher
     list to be accepted by <productname>Pgpool-II</>, is added.
     This is already implemented in <productname>PostgreSQL</> and useful to enhance security when SSL is enabled. 
     -->
     <productname>Pgpool-II</>がクライアントからのSSL接続を受け付ける際に受け入れる暗号のリストを指定する新しいパラメータ、
     <xref linkend="guc-ssl-ciphers">を追加しました。これはすでに<productname>PostgreSQL</>に実装されていて、
      SSLが有効なときにセキュリティを強化するのに役立ちます。
    </para>
   </listitem>
  </itemizedlist>
 </sect2>

 <sect2>
  <!--
  <title>Bug fixes</title>
  -->
  <title>不具合修正</title>
  <itemizedlist>
   <listitem>
    <!--
    2019-03-18 [6224e9a]
    -->
    <para>
     <!--
     Fix unnecessary <function>fsync()</> to <filename>pgpool_status</> file. (Tatsuo Ishii)
     -->
     不要な<filename>pgpool_status</>ファイルへの書き込みが減らしました。(Tatsuo Ishii)
    </para>
    <para>
     <!--
     Whenever new connections are created to PostgreSQL backend, <function>fsync()</>
     was issued to <filename>pgpool_status</> file, which could generate excessive I/O
     in certain conditions.
     So reduce the chance of issuing <function>fsync()</> so that it is issued only when
     backend status is changed.
     -->
     今までは<productname>PostgreSQL</>バックエンドへの新しい接続が作成されるたびに、
     <filename>pgpool_status</>ファイルに書き込むために<function>fsync()</>が実行されていましたが、
     これにより、特定の条件で過剰なI/Oを発生させる可能性がありました。
     そのため、バックエンドの状況が変更されたときにのみ<function>fsync()</>を実行するように修正しました。
    </para>
    <para>
     <!--
     Discussion: <ulink url="http://www.sraoss.jp/pipermail/pgpool-general/2019-February/006494.html">[pgpool-general: 6436]</ulink>
     -->
     ディスカッション: <ulink url="http://www.sraoss.jp/pipermail/pgpool-general/2019-February/006494.html">[pgpool-general: 6436]</ulink>
    </para>
   </listitem>

   <listitem>
    <!--
    2019-03-22 [3f282a7]
    2019-03-06 [a1c617d]
    2019-03-05 [5a8d511]
    -->
    <para>
     <!--
     Doc: add more explanation to <xref linkend="guc-follow-primary-command">. (Tatsuo Ishii)
     -->
     Doc：<xref linkend="guc-follow-primary-command">に関する説明を追加しました。(Tatsuo Ishii)
    </para>
    <para>
     <!--
     Add description how <xref linkend="guc-follow-primary-command"> is executed etc.
     -->
     <xref linkend="guc-follow-primary-command">の実行条件などの説明を追加しました。
    </para>
   </listitem>

   <listitem>
    <!--
    2019-02-24 [2f16794]
    -->
    <para>
     <!--
     Docs: add note to <xref linkend="guc-detach-false-primary"> configuration parameter. 
     (<ulink url="http://www.pgpool.net/mantisbt/view.php?id=469">bug 469</ulink>) (Tatsuo Ishii)
     -->
     Doc: <xref linkend="guc-detach-false-primary">設定パラメータに関する注意事項を追加しました。 
      (<ulink url="http://www.pgpool.net/mantisbt/view.php?id=469">bug 469</ulink>) (Tatsuo Ishii)
    </para>
    <para>
     <!--
     To use this feature, <xref linkend="guc-sr-check-user"> must be super user or in pg_monitor group.
     -->
     この機能を使用するには、<xref linkend="guc-sr-check-user">に設定したユーザがスーパーユーザまたはpg_monitorグループに属している必要があります。
    </para>
   </listitem>
  </itemizedlist>
 </sect2>
</sect1>

<sect1 id=release-4-0-3> 
 <!--
 <title>Release 4.0.3</title>
 -->
 <title>リリース 4.0.3</title>
 <note>
  <!--
  <title>Release Date</title>
  -->
  <title>リリース日</title>
  <simpara>2019-02-21</simpara>
 </note>

 <sect2>
  <!--
  <title>Changes</title>
  -->
  <title>変更点</title>
  <itemizedlist>
   <listitem>
    <!--
    2019-02-20 [6136946]
    -->
    <para>
     <!--
     Doc: Update configuration example <xref linkend="EXAMPLE-CLUSTER">. (Bo Peng)
     -->
     Doc: 設定の例<xref linkend="EXAMPLE-CLUSTER">を更新しました. (Bo Peng)
    </para>
   </listitem>
  </itemizedlist>
 </sect2>

 <sect2>
  <!--
  <title>Bug fixes</title>
  -->
  <title>不具合修正</title>
  <itemizedlist>
   <listitem>
    <!--
    2019-02-18 [8537db8]
    -->
    <para>
     <!--
     Skip over "host=" when getting info from conninfo string. (Bo Peng)
     -->
     <literal>conninfo</literal>から情報を取得するときに、<literal>"host ="</literal> をスキップするように修正しました。(Bo Peng)
    </para>
    <para>
     <!--
     Patch provided by Nathan Ward.
     -->
     パッチはNathan Wardによって提供されました。
    </para>
   </listitem>

   <listitem>
    <!--
    2019-02-15 [4e8ef64]
    -->
    <para>
     <!--
     Test: Fix old JDBC functions and typos in regression test 068.memqcache_bug. (Takuma Hoshiai)
     -->
     Test: レグレッションテスト068.memqcache_bugの古いJDBCの関数及びタイポを修正しました。(Takuma Hoshiai)
    </para>
   </listitem>

   <listitem>
    <!--
    2019-02-15 [07ab0c9]
    -->
    <para>
     <!--
     Doc: Fix configuration change timing regarding memory_cache_enabled. (Tatsuo Ishii)
     -->
     Doc: <xref linkend="GUC-MEMORY-CACHE-ENABLED">パラメータはサーバ起動時にのみ設定可能なことをドキュメントに追加しました。(Tatsuo Ishii)
    </para>
   </listitem>

   <listitem>
    <!--
    2019-02-12 [f958290]
    -->
    <para>
     <!--
     Fix online recovery failed due to client_idle_limit_in_recovery in certain cases. 
     (<ulink url="http://www.pgpool.net/mantisbt/view.php?id=431">bug 431</ulink>)(Tatsuo Ishii)
     -->
     特定の場合に、<xref linkend="GUC-CLIENT-IDLE-LIMIT-IN-RECOVERY">によって、オンラインリカバリが失敗する不具合を修正しました。(<ulink url="http://www.pgpool.net/mantisbt/view.php?id=431">bug 431</ulink>)(Tatsuo Ishii)
    </para>
   </listitem>

   <listitem>
    <!--
    2019-02-05 [b99e62d]
    -->
    <para>
     <!--
     Reduce memory usage when large data set is returned from backend. 
     (<ulink url="http://www.pgpool.net/mantisbt/view.php?id=462">bug 462</ulink>) (Tatsuo Ishii)
     -->
     大きなデータがバックエンドから返されたときのメモリ使用量を減らすように修正しました。(<ulink url="http://www.pgpool.net/mantisbt/view.php?id=462">bug 462</ulink>) (Tatsuo Ishii)
    </para>
   </listitem>

   <listitem>
    <!--
    2019-02-05 [9f127d6]
    -->
    <para>
     <!--
     Test: Fix syntax error in extended query test script. (Tatsuo Ishii)
     -->
     Test: 拡張問い合わせのテストスクリプトのエラーを修正しました。(Tatsuo Ishii)
    </para>
   </listitem>

   <listitem>
    <!--
    2019-01-29 [f7427e2]
    -->
    <para>
     <!--
     Fix corner case bug when strip_quote() handle a empty query string. <ulink url="http://www.pgpool.net/mantisbt/view.php?id=458">(bug 458</ulink>) (Tatsuo Ishii)
     -->
     <function>strip_quote()</function>が空のクエリを処理するときに発生するセグメンテーション違反を修正しました。<ulink url="http://www.pgpool.net/mantisbt/view.php?id=458">(bug 458</ulink>) (Tatsuo Ishii)
    </para>
   </listitem>

   <listitem>
    <!--
    2019-01-27 [cf5a528]
    -->
    <para>
     <!--
     Doc: Mention that schema qualifications cannot be used in white/black_function_list. (Tatsuo Ishii)
     -->
     Doc: white/black_function_list 設定パラメータでスキーマ修飾が使えないという説明を追加しました。(Tatsuo Ishii)
    </para>
   </listitem>

   <listitem>
    <!--
    2019-01-23 [66fd1c6]
    -->
    <para>
     <!--
     Fix typo about wd_priority in watchdog_setup. (Takuma Hoshiai)
     -->
     <command>watchdog_setup</command>スクリプトの<xref linkend="GUC-WD-PRIORITY">に関するタイポを修正しました。(Takuma Hoshiai)
    </para>
   </listitem>

   <listitem>
    <!--
    2019-01-18 [3ae4acf]
    -->
    <para>
     <!--
     Fixed segfault when <varname>wd_lifecheck_method = 'query'</varname>. (<ulink url="http://www.pgpool.net/mantisbt/view.php?id=455">bug 455</ulink>)(Muhammad Usama)
     -->
     <varname>wd_lifecheck_method = 'query'</varname> の場合に発生するセグメンテーション違反を修正しました。(<ulink url="http://www.pgpool.net/mantisbt/view.php?id=455">bug 455</ulink>)(Muhammad Usama)
    </para>
    <para>
     <!--
     The fix was proposed by me and some adjustments to the patch and testing is done by Yugo Nagata.
     -->
     パッチがMuhammad Usama によって作成され、Yugo Nagata によってテストされました。
    </para>
   </listitem>

   <listitem>
    <!--
    2019-01-10 [5234b6e]
    -->
    <para>
     <!--
     Fix Pgpool child segfault if failover occurs when trying to establish a connection. (Tatsuo Ishii)
     -->
     接続を確立しようとするとき、フェイルオーバが発生する場合に発生しうるセグメンテーション違反を修正しました。(Tatsuo Ishii)
    </para>
    <para>
     参照: <ulink url="https://www.pgpool.net/pipermail/pgpool-hackers/2019-January/003214.html">[pgpool-hackers: 3214]</ulink>
    </para>
   </listitem>

   <listitem>
    <!--
    2019-01-03 [de632ca]
    -->
    <para>
     <!--
     Doc: fix typo in logdir description. (<ulink url="http://www.pgpool.net/mantisbt/view.php?id=453">bug 453</ulink>)(Tatsuo Ishii)
     -->
     Doc: <xref linkend="GUC-LOGDIR">に関するドキュメントのタイポを修正しました。(<ulink url="http://www.pgpool.net/mantisbt/view.php?id=453">bug 453</ulink>)(Tatsuo Ishii)
    </para>
   </listitem>

   <listitem>
    <!--
    2018-12-25 [cad088b]
    -->
    <para>
     <!--
     Fix <acronym>PAM</acronym> authentication failed. (Takuma Hoshiai)
     -->
     <acronym>PAM</acronym>認証が失敗する不具合を修正しました。(Takuma Hoshiai)
    </para>
    <para>
     <!--
     See <ulink url="https://www.pgpool.net/pipermail/pgpool-general/2018-December/006411.html">[pgpool-general: 6353]</ulink> for more details.
     -->
     詳細は<ulink url="https://www.pgpool.net/pipermail/pgpool-general/2018-December/006411.html">[pgpool-general: 6353]</ulink>を参照してください。
    </para>
   </listitem>

   <listitem>
    <!--
    2018-12-12 [050b5da]
    -->
    <para>
     <!--
     Fix Pgpool-II hang if a client sends a extended query message such as close after sync message but before next simple query. (Tatsuo Ishii)
     -->
     クライアントが sync メッセージの後、次の簡易問い合わせの前に close メッセージを送ると発生しうるハングアップを修正しました。(Tatsuo Ishii)
    </para>
    <para>
     参照: <ulink url="https://www.pgpool.net/pipermail/pgpool-hackers/2018-December/003164.html">[pgpool-hackers: 3164]</ulink>
    </para>
   </listitem>

   <listitem>
    <!--
    2018-12-06 [3f5986e]
    -->
    <para>
     <!--
     Fix Pgpool-II hang when "idle_in_transaction_session_timeout=on". (<ulink url="http://www.pgpool.net/mantisbt/view.php?id=448">bug 448</ulink>)(Tatsuo Ishii)
     -->
     <productname>PostgreSQL</productname>の<varname>idle_in_transaction_session_timeout</varname>が有効な場合に発生しうる<productname>Pgpool-II</productname>のハングアップを修正しました。(<ulink url="http://www.pgpool.net/mantisbt/view.php?id=448">bug 448</ulink>)(Tatsuo Ishii)
    </para>
   </listitem>
  </itemizedlist>
 </sect2>
</sect1>

<sect1 id=release-4-0-2> 
 <!--
 <title>Release 4.0.2</title>
 -->
 <title>リリース 4.0.2</title>
 <note>
  <!--
  <title>Release Date</title>
  -->
  <title>リリース日</title>
  <simpara>2018-11-22</simpara>
 </note>

 <sect2>
  <!--
  <title>Bug fixes</title>
  -->
  <title>不具合修正</title>
  <itemizedlist>

   <listitem>
    <!--
    2018-11-21 [965d315]
    -->
    <para>
     <!--
     Fix to sort startup packet's parameters sent by client. 
     (<ulink url="http://www.pgpool.net/mantisbt/view.php?id=444">bug 444</ulink>)(Takuma Hoshiai)
     -->
     クライアントから送信された startup パケットのパラメータをソートするように修正します。
     (<ulink url="http://www.pgpool.net/mantisbt/view.php?id=444">bug 444</ulink>)(Takuma Hoshiai)
    </para>
    <para>
     <!--
     If order of startup packet's parameters differ between cached connection
     pools and connection request, did't use connection pool ,and created new
     connection pool.
     -->
     キャッシュされたコネクションプールと接続要求のstartupパケットのパラメータの順序が異なる場合、
     コネクションプールを使用せず、新しいコネクションプールを作成しまていました。
    </para>
   </listitem>
   
   <listitem>
    <!--
    2018-11-16 [e00426d]
    -->
    <para>
     <!--
     Fix broken authentication for <productname>Pgpool-II</>'s internal connections. (Muhammad Usama)
     -->
     <productname>Pgpool-II</>の内部接続の認証の不具合を修正しました。(Muhammad Usama)
    </para>
    <para>
     <!--
     The issue is caused by a  mistake in "SCRAM and Certificate authentication 
     support" commit. The problem is while authenticating against backend in
     <function>connection_do_auth()</>, it returns to caller as soon as backend returns auth
     ok response.  So authentication itself established fine. However
     <function>connection_do_auth()</> does not proceed until it receives "Ready for query".
     The fix is to keep processing the data after receiving auth_ok response until we get
     "Ready for query".
     -->
     これは「SCRAM認証と証明書の認証のサポート」の機能追加による問題です。
     問題は、<function>connection_do_auth()</>でバックエンドに対して認証する際に、
     バックエンドが「認証 ok」との応答を返すと
     すぐに呼び出し元にもどっていました。そのため、認証自体は成功しましたが、
     <function>connection_do_auth()</>は「Ready for query」を受信するまで処理を進めませんでした。
     「認証 ok」との応答を受け取った後も「Ready for query」を受信するまでデータの処理を継続するように修正しました。
    </para>
    <para>
     <!--
     Patch provided by Tatsuo Ishii and a tiny modification made by Muhammad Usama.
     -->
     パッチがTatsuo Ishiiにより提供され、Muhammad Usamaにより修正されました。
    </para>
   </listitem>
   
   <listitem>
    <!--
    2018-11-13 [11ea13b]
    -->
    <para>
     <!--
     Fix compiler warnings with gcc 8.x. (Takuma Hoshiai)
     -->
     gcc 8.xで発生するコンパイラの警告を修正しました。(Takuma Hoshiai)
    </para>
   </listitem>
   
   <listitem>
    <!--
    2018-11-13 [1305595]
    -->
    <para>
     <!--
     Fix segmentation fault occurs when a certain Bind message is sent in native replication mode. 
     (<ulink url="http://www.pgpool.net/mantisbt/view.php?id=443">bug 443</ulink>)(Bo Peng)
     -->
     ネイティブレプリケーションモードで特定のBindメッセージが送信されたときに発生するセグメンテーション違反を修正しました。
     (<ulink url="http://www.pgpool.net/mantisbt/view.php?id=443">bug 443</ulink>) (Bo Peng)
    </para>
    <para>
     <!--
     If the number of parameter format codes is specified to one, but the number
     of the original query's parameter is zero, bind_rewrite_timestamp() will
     call memcpy with a negative value. This causes segmentation fault.
     -->
     パラメータ書式コードの数が 1 に指定されて、元のクエリのパラメータの数が 0 の場合、
     <function>bind_rewrite_timestamp()</>に負の値を指定して<function>memcpy</>を呼び出していました。
     これによりセグメンテーション違反が発生していました。
    </para>
    <para>
     <!--
     Patch is provided by Yugo Nagata.
     -->
     パッチがYugo Nagataにより提供されました。
    </para>
   </listitem>
   
   <listitem>
    <!--
    2018-11-08 [97caaac]
    -->
    <para>
     <!--
     Fix a query passed to relcache so that it uses schema qualified table name. (Tatsuo Ishii)
     -->
     スキーマ名で修飾されたテーブル名を使用するようにクエリキャッシュに渡されるクエリを修正しました。(Tatsuo Ishii)
    </para>
   </listitem>
   
   <listitem>
    <!--
    2018-11-05 [e9db542]
    -->
    <para>
     <!--
     Fix query cache invalidation bug. (Tatsuo Ishii)
     -->
     クエリキャッシュ無効化のバグを修正しました。(Tatsuo Ishii)
    </para>
   </listitem>
   
   <listitem>
    <!--
    2018-11-03 [53e4c80]
    -->
    <para>
     <!--
     Fix segfault in extended query + query cache case. (Tatsuo Ishii)
     -->
     拡張問い合わせかつクエリキャッシュ有効の場合に発生するセグメンテーション違反を修正しました。(Tatsuo Ishii)
    </para>
   </listitem>
   
   <listitem>
    <!--
    2018-11-01 [3d8e0fb]
    -->
    <para>
     <!--
     Fix memory leak in extended query + query cache enabled. (Tatsuo Ishii)
     -->
     拡張問い合わせかつクエリキャッシュ有効の場合に発生するメモリリークを修正しました。(Tatsuo Ishii)
    </para>
   </listitem>
  </itemizedlist>
 </sect2>
</sect1>

<sect1 id="release-4-0-1">
 <!--
 <title>Release 4.0.1</title>
 -->
 <title>リリース 4.0.1</title>
 <note>
  <!--
  <title>Release Date</title>
  -->
  <title>リリース日</title>
  <simpara>2018-10-31</simpara>
 </note>

 <sect2>
  <!--
  <title>Changes</title>
  -->
  <title>変更点</title>
  <itemizedlist>
   <listitem>
    <!--
    2018-10-30 [25a3024]
    -->
    <para>
     <!--
     Allow ssl key files to be owned by users other than <productname>Pgpool-II</productname> user and root. (Muhammad Usama)
     -->
     <productname>Pgpool-II</productname>の実行ユーザとrootユーザ以外のユーザがsslキーファイルを所有することができるようになりました。(Muhammad Usama)
    </para>
   </listitem>

   <listitem>
    <!--
    2018-10-30 [3d0311b]
    -->
    <para>
     <!--
     Allow <command>PCP[attach/detach/promote]</command> commands during failover. (Muhammad Usama)
     -->
     フェイルオーバ時に<command>PCP[attach/detach/promote]</command>コマンドを許可するようになりました。(Muhammad Usama)
    </para>
   </listitem>
  </itemizedlist>
 </sect2>

 <sect2>
  <!--
  <title>Bug fixes</title>
  -->
  <title>不具合修正</title>
  <itemizedlist>
   <listitem>
    <!--
    2018-10-30 [d48cc28]
    -->
    <para>
     <!--
     Fix corruption of <xref linkend="GUC-pool-passwd"> file due to the different lengths of md5, AES and text type passwords. (Muhammad Usama)
     -->
     <literal>MD5</literal>、<literal>AES</literal>及びテキストパスワードの長さが異なることによって時々発生する<xref linkend="GUC-pool-passwd">ファイルの破損を修正しました。(Muhammad Usama)
    </para>
    <para>
     パッチはTakuma Hoshiaiによって提供され、Muhammad Usamaによって修正されました。
    </para>
   </listitem>

   <listitem>
    <!--
    2018-10-25 [3189c36]
    -->
    <para>
     <!--
     Fix typo in <varname>child_max_connections</varname> description of <command>SHOW POOL_STATUS</command> output. (Tatsuo Ishii)
     -->
     <command>SHOW POOL_STATUS</command>コマンドの出力の<varname>child_max_connections</varname>の説明のタイポを修正しました。(Tatsuo Ishii)
    </para>
    <para>
     <!--
     Patch provided by Phil Ramirez.
     -->
     パッチはPhil Ramirezにより提供されました。
    </para>
   </listitem>

   <listitem>
    <!--
    2018-10-22 [5e6d598]
    -->
    <para>
     <!--
     Fix segmentation fault when error query and Sync message are sent in native replication mode. (<ulink url="http://www.pgpool.net/mantisbt/view.php?id=434">bug 434</ulink>) (Takuma Hoshiai)
     -->
     ネイティブレプリケーションモードでエラークエリと同期メッセージが送信されたときのセグメンテーション違反を修正しました。
     (<ulink url="http://www.pgpool.net/mantisbt/view.php?id=434">bug 434</ulink>) (Takuma Hoshiai)
    </para>
    <para>
     <!--
     In native replication mode, segmentation fault occurs when Sync messages is sent just after a query error.
     -->
     ネイティブレプリケーションモードで、クエリエラーの後に同期メッセージが送信されるとセグメンテーション違反が発生していました。
    </para>
   </listitem>
  </itemizedlist>
 </sect2>
</sect1>

<sect1 id="release-4-0">
 <!--
 <title>Release 4.0</title>
 -->
 <title>リリース 4.0</title>
 <note>
  <!--
  <title>Release Date</title>
  -->
  <title>リリース日</title>
  <simpara>2018-10-19</simpara>
 </note>

 <sect2>
  <!--
  <title>Overview</title>
  -->
  <title>概要</title>
  <para>
   <!--
   This version addes support for SCRAM and CERT authentication,
   improves load balancing control and import PostgreSQL 11
   new SQL parser.
   -->
   このバージョンでは、<acronym>SCRAM</acronym>認証および証明書認証に対応し、ロードバランスの制御が向上しており、<productname>PostgreSQL</productname>11の新しい<literal>SQL</literal>パーサを取り込んでいます。
  </para>
  <para>
   <!--
   Major enhancements in <productname>Pgpool-II</productname> 4.0 include:
   -->
   <productname>Pgpool-II</productname>4.0の主な改善点は以下のとおりです。
  </para>

  <!-- Items in this list summarize one or more items below -->

  <itemizedlist>
   <listitem>
    <para>
     <!--
     Add <acronym>SCRAM</acronym> and Certificate authentication support.
     -->
     <acronym>SCRAM</acronym>認証および証明書認証の対応
    </para>
   </listitem>
   <listitem>
    <para>
     <!--
     Detecting "false" primary server of <productname>PostgreSQL</productname>.
     -->
     <productname>PostgreSQL</productname>の偽のプライマリサーバ検出
    </para>
   </listitem>

   <listitem>
    <para>
     <!--
     Improvement of load balancing:
     -->
     ロードバランスの改善:
     <itemizedlist>
      <listitem>
       <para>
	<!--
	More load balancing fine control after write queries.
	-->
	更新を伴うクエリ実行後の更に細かい負荷分散の制御
       </para>
      </listitem>
      <listitem>
       <para>
	<!--
	Load balancing control for specific queries.
	-->
	特定クエリに対する負荷分散の制御
       </para>
      </listitem>
      <listitem>
       <para>
	<!--
	Allow to specify load balance weight ratio for load balance parameters.
	-->
	パラメータによる負荷分散の重み指定

       </para>
      </listitem>
     </itemizedlist>
    </para>
   </listitem>

   <listitem>
    <para>
     <!--
     Add last state change timestamp to <xref linkend="SQL-SHOW-POOL-NODES">.
     -->
     <xref linkend="SQL-SHOW-POOL-NODES"> に最終更新時刻のタイムスタンプ追加
    </para>
   </listitem>

   <listitem>
    <para>
     <!--
     Import PostgreSQL 11 SQL parser.
     -->
     PostgreSQL11のSQLパーサの取込
    </para>
   </listitem>

   <listitem>
    <para>
     <!--
     Logging client messages.
     -->
     クライアントメッセージのログ出力の追加
    </para>
   </listitem>
  </itemizedlist>
 </sect2>

 <sect2>
  <!--
  <title>Migration to Version 4.0</title>
  -->
  <title>バージョン4.0への移行</title>
  <para>
   <!--
   Version 4.0 contains a number of changes that may affect compatibility with
   previous releases. Observe the following incompatibilities:
   -->
   バージョン4.0には、以前のバージョンとの互換性に影響する多数の変更点が含まれています。
   以下の非互換性に注意してください。
  </para>
  <itemizedlist>
   <listitem>
    <!--
    2018-04-16 [3d63b8a]
    2018-05-04 [2e41451]
    -->
    <para>
     <!--
     Add 1st/2nd stage online recovery commands parameter to get the node number to be recovered. (Tatsuo Ishii)
     -->
     1st/2nd ステージのオンラインリカバリコマンドにリカバリされるノードの番号を取得するためのパラメータを追加しました。(Tatsuo Ishii)
    </para>
    <para>
     <!--
     Online recovery script now accepts 5 parameters, rather than 4 (the 5th
     parameter is node number to be recovered).
     Run <command>ALTER EXTENSION pgpool_recovery UPDATE TO '1.2'</command>
     to update <literal>pgpool_recovery</literal> version.
     Existing 4-parameter-style recovery scripts can be used if you don't care
     about information provided by the 5th parameter.
     -->
     オンラインリカバリスクリプトは4つではなく5つのパラメータを受け取るようになりました（5番目のパラメータはリカバリされるノードの番号です）。
     <literal>pgpool_recovery</literal>をバージョンアップするためには、<command>ALTER EXTENSION pgpool_recovery UPDATE TO '1.2'</command>を実行してください。
     5番目のパラメータの情報を必要としない場合、既存の4つのパラメータの形式でリカバリスクリプト使用することが出来ます。
    </para>
    <para>
     <!--
     See <xref linkend="guc-recovery-1st-stage-command"> and
     <xref linkend="guc-recovery-2nd-stage-command"> for more details.
     -->
     詳細は、<xref linkend="guc-recovery-1st-stage-command">と<xref linkend="guc-recovery-2nd-stage-command">を参照してください。
    </para>
   </listitem>
   <listitem>
    <!--
    2018-08-19 [e47f8a3]
    -->
    <para>
     <!--
     <varname>fail_over_on_backend_error</varname> parameter is renamed to
     <xref linkend="guc-failover-on-backend-error">. (Muhammad Usama)
     -->
     パラメータ<varname>fail_over_on_backend_error</varname>は、<xref linkend="guc-failover-on-backend-error">に変更されました。(Muhammad Usama)
    </para>
    <para>
     <!--
     Now we throw a warning message when old config name <varname>fail_over_on_backend_error</varname>
     is used instead of <xref linkend="guc-failover-on-backend-error">.
     Using the old config variable name will have no effect.
     -->
     <xref linkend="guc-failover-on-backend-error">の代わりに古いパラメータ名<varname>fail_over_on_backend_error</varname>が使われた場合、警告メッセージを出力します。
    </para>
   </listitem>
   <listitem>
    <!--
    2018-08-17 [2644612]
    -->
    <para>
     <!--
     Allow to specify the AES encrypted password in the <filename>pgpool.conf</filename>. (Muhammad Usama)
     -->
     <filename>pgpool.conf</filename>内でAESで暗号化されたパスワードを指定できます。(Muhammad Usama)
    </para>
    <para>
     <!--
     Since 4.0, you can specify the AES encrypted password in the
     <filename>pgpool.conf</filename> file for <xref linkend="guc-health-check-password">,
     <xref linkend="guc-sr-check-password">, <xref linkend="guc-wd-lifecheck-password"> and
     <xref linkend="guc-recovery-password">.
     -->
     4.0以降では、<filename>pgpool.conf</filename>ファイル内の<xref linkend="guc-health-check-password">および<xref linkend="guc-sr-check-password">、<xref linkend="guc-wd-lifecheck-password">、<xref linkend="guc-recovery-password">でAESで暗号化されたパスワードを指定することができます。
    </para>
    <para>
     <!--
     To specify the unencrypted clear text password, prefix the password string with <literal>TEXT</literal>.
     In the absence of a valid prefix, <productname>Pgpool-II</productname> will considered the string as a plain text password.
     -->
     パスワード文字列の先頭に<literal>TEXT</literal>を付与した暗号化されていないクリアテキストパスワードを指定します。
     有効な接頭辞が無い場合、<productname>Pgpool-II</productname>は文字列を平文のパスワードと見なします。
    </para>
    <para>
     <!--
     The empty password string specified in the
     <filename>pgpool.conf</filename> file for <xref linkend="guc-health-check-password">,
     <xref linkend="guc-sr-check-password">, <xref linkend="guc-wd-lifecheck-password"> and
     <xref linkend="guc-recovery-password"> will only be used when the <xref linkend="GUC-pool-passwd">
     does not contain the password for that specific user.
     If these parameters are left blank, <productname>Pgpool-II</productname> will first try to
     get the password for that specific user from <xref linkend="GUC-pool-passwd"> file before
     using the empty password.
     -->
     <filename>pgpool.conf</filename>ファイル内の<xref linkend="guc-health-check-password">および<xref linkend="guc-sr-check-password">、<xref linkend="guc-wd-lifecheck-password">、<xref linkend="guc-recovery-password">で指定された空のパスワード文字列は、<xref linkend="GUC-pool-passwd">が特定のパスワードを含まない場合だけ使われます。
	  もし、これらのパラメータが空白だった場合、<productname>Pgpool-II</productname>は空のパスワードを使用する前に最初に<xref linkend="GUC-pool-passwd">ファイルから特定のユーザのパスワードの取得を試みます。
    </para>
   </listitem>
  </itemizedlist>
 </sect2>

 <sect2>
  <!--
  <title>Major Enhancements</title>
  -->
  <title>主要な改善点</title>
  <itemizedlist>
   <listitem>
    <!--
    2018-09-05 [536b155]
    2018-08-19 [ccc9280]
    2018-08-17 [2644612]
    -->
    <para>
     <!--
     Add support for <acronym>SCRAM</acronym> and Certificate
     based authentication methods. (Muhammad Usama)
     -->
     <acronym>SCRAM</acronym>認証および証明書認証に対応しました。(Muhammad Usama)
     <itemizedlist>
      <listitem>
       <para>
	<!--
	Add support for <acronym>SCRAM</acronym> authentication method.
	-->
	<acronym>SCRAM</acronym>認証方式に対応しました。
       </para>
       <para>
	<!--
	SCRAM authentication is supported using the pool_passwd authentication file.
	-->
	pool_passwd認証ファイルを使用したSCRAM認証に対応しました。
       </para>
       <para>
	<!--
	See <xref linkend="AUTH-SCRAM"> for more details.
	-->
	詳細は<xref linkend="AUTH-SCRAM">を参照してください。
       </para>
      </listitem>
      <listitem>
       <para>
	<!--
	Allow to use <acronym>CERT</acronym> authentication between <productname>Pgpool-II</productname> and frontend.
	-->
	<productname>Pgpool-II</productname>とフロントエンドの間で<acronym>CERT</acronym>認証を使用できます。
       </para>
       <para>
	<!--
	To use this authentication method, Pgpool-II will require that the client provide a valid certificate.
	-->
	この認証方法を使用する場合、Pgpool-IIはクライアントが有効な証明書を提供することを必要とします。
       </para>
       <para>
	<!--
	See <xref linkend="AUTH-CERT"> for more details.
	-->
	詳細は<xref linkend="AUTH-CERT">を参照してください。
       </para>
      </listitem>
      <listitem>
       <para>
	<!--
	Able to use different auth methods for frontend and backend.
	-->
	フロントエンド/バックエンドで異なる認証方式を利用できます。
       </para>
       <para>
	<!--
	Now it is possible to use different authentication methods between
	client to <productname>Pgpool-II</productname> and <productname>Pgpool-II</productname> to backend.
	-->
	これはクライアントと<productname>Pgpool-II</productname>、および<productname>Pgpool-II</productname>とバックエンド間で異なる認証方式を利用できます。
       </para>
      </listitem>
     </itemizedlist>
     <itemizedlist>
      <listitem>
       <para>
	<!--
	Now <xref linkend="GUC-POOL-PASSWD"> can store three format passwords. AES256 encrypted format, plain text format and md5 format.
	-->
	<xref linkend="GUC-POOL-PASSWD">は、3つの形式でパスワードを保存できるようになりました。
	 AES256暗号化形式、平文形式、md5形式です。
       </para>
       <para>
	<!--
	<productname>Pgpool-II</productname> identifies the password format type by it's prefix,
	so each password entry in the pool_passwd must be prefixed as per the password format.
	-->
	<productname>Pgpool-II</productname>は接頭辞によってパスワードの形式を確認するため、pool_passwd内の各パスワードのエントリはパスワードの形式を接頭語として付ける必要があります。
       </para>
       <para>
	<!--
	md5 hashed passwords will be prefixed with <literal>md5</literal> and AES256 encrypted password types
	will be stored using <literal>AES</literal> prefix.
	To store the password in the plain text format <literal>TEXT</literal> prefix can be used.
	-->
	md5ハッシュパスワードは<literal>md5</literal>接頭辞、AES256暗号化パスワード形式は<literal>AES</literal>接頭辞を使って保存することができます。
	平文形式のパスワードの保存のためには、<literal>TEXT</literal>接頭辞を使用できます。
       </para>
       <para>
	<!--
	In the absence of a valid prefix, Pgpool-II will be considered the string as a plain text password.i
	-->
	有効な接頭辞がない場合、Pgpool-IIは文字列を平文のパスワードとして見なします。
       </para>
       <para>
	<!--
	For example:
	-->
	例:
	<programlisting>
	 username1:AESIFwI86k+ZbVdf6C+t3qpGA==
	 username2:md59c6583185ba6a85bdcd1f129ec8cabb4
	 username3:TEXTmypassword
	</programlisting>
       </para>
      </listitem>
     </itemizedlist>
     <itemizedlist>
      <listitem>
       <para>
	<!--
	Able to use <acronym>MD5</acronym> and <acronym>SCRAM</acronym> authentication methods
	to connect to database without <xref linkend="GUC-pool-passwd">.
	-->
	<xref linkend="GUC-pool-passwd">を用いずにデータベースへの接続に<acronym>MD5</acronym>認証および<acronym>SCRAM</acronym>認証方式を使えます。
       </para>
       <para>
	<!--
	A new configuration parameter <xref linkend="guc-allow-clear-text-frontend-auth"> is added.
	This parameter enables this config allows the <productname>Pgpool-II</productname>
	to use clear-text-password authentication with frontend clients when
	<xref linkend="GUC-pool-passwd"> file does not contain the password for the connecting user,
	and use that password (provided by client) to authenticate with the backend
	using <acronym>MD5</acronym> and/or <acronym>SCRAM</acronym> authentication.
	-->
	新しい設定パラメータ<xref linkend="guc-allow-clear-text-frontend-auth">を追加しました。
	 このパラメータは接続するユーザのパスワードが<xref linkend="GUC-pool-passwd">ファイルに含まれていない、かつ（クライアントから提供された）パスワードがバックエンドの<acronym>MD5</acronym>もしくは<acronym>SCRAM</acronym>認証で使われる場合、<productname>Pgpool-II</productname>がクライアントとのクリアテキストのパスワード認証を行うことを許可します。
       </para>
      </listitem>
     </itemizedlist>
     <itemizedlist>
      <listitem>
       <para>
	<!--
	New <xref linkend="PG-ENC"> utility to create encrypted passwords.
	-->
	新しい<xref linkend="PG-ENC">コマンドは、暗号化されたパスワードを生成します。
       </para>
       <para>
	<!--
	A new utility <xref linkend="PG-ENC"> is added to create AES encrypted passwords.
	-->
	AESで暗号化されたパスワードを作成できる<xref linkend="PG-ENC">コマンドを追加しました。

       </para>
      </listitem>
     </itemizedlist>
    </para>
    <para>
     <!--
     See <xref linkend="client-authentication"> for more details.
     -->
     詳細は、<xref linkend="client-authentication">を参照してください。
    </para>
   </listitem>

   <listitem>
    <!--
    2018-04-09 [f0631a6]
    2018-04-17 [bbc270f]
    -->
    <para>
     <!--
     Add new parameter <xref linkend="guc-detach-false-primary">. (Tatsuo Ishii)
     -->
     新しいパラメータ<xref linkend="guc-detach-false-primary">を追加しました。 (Tatsuo Ishii)
    </para>
    <para>
     <!--
     If set <literal>detach_false_primary = on</literal>, detach false primary node.
     The default is off. This parameter is only valid in streaming replication mode
     and for <productname>PostgreSQL</productname> 9.6 or after since this feature
     uses <structname>pg_stat_wal_receiver</structname>.
     If <productname>PostgreSQL</productname> 9.5.x or older version is used, no
     error is raised, just the feature is ignored.
     -->
     <literal>detach_false_primary = on</literal>の場合、偽のプライマリノードを切り離します。
     デフォルトはoffです。<structname>pg_stat_wal_receiver</structname>を使用しているため、このパラメータはストリーミングレプリケーションモードかつ<productname>PostgreSQL</productname>9.6以降でのみ有効です。
     <productname>PostgreSQL</productname>9.5以前のバージョンの場合、エラーは発生せずこの機能は無視されます。
    </para>
   </listitem>
   <listitem>
    <!--
    2018-04-23 [33e52ba]
    2018-04-19 [ba19a38]
    -->
    <para>
     <!--
     Add <xref linkend="guc-disable-load-balance-on-write"> parameter to specify
     load balance behavior after write queries appear. (Tatsuo Ishii)
     -->
     更新を含むクエリ実行後の負荷分散の振る舞いを指定する<xref linkend="guc-disable-load-balance-on-write">を追加しました。(Tatsuo Ishii)
    </para>
    <para>
     <!--
     This parameter allows to specify the behavior when a write query issued.
     -->
     このパラメータは、更新クエリ実行後の振る舞いを指定できます。
    </para>
   </listitem>
   <listitem>
    <!--
    2018-08-07 [5108031]
    -->
    <para>
     <!--
     Allow to specify load balance weight ratio for load balance parameters. (Bo Peng)
     -->
     パラメータとして負荷分散の重みの割合を指定できるようになりました。(Bo Peng)
    </para>
    <para>
     <!--
     Add a new feature to allow to specify load balance weight ratio for
     <xref linkend="guc-database-redirect-preference-list"> and
     <xref linkend="guc-app-name-redirect-preference-list"> parameters.
     -->
     新しい機能として<xref linkend="guc-database-redirect-preference-list">および<xref linkend="guc-app-name-redirect-preference-list">に対して負荷分散の重みを指定できます。

    </para>
    <para>
     <!--
     You can specify the list of "database-name:node id(ratio)" pairs to
     send SELECT queries to a particular backend node for a particular
     database connection at a specified load balance ratio.
     -->
     特定のデータベース接続およびバックエンドノードに対して、指定した負荷分散の比でSELECTクエリを送るためのリスト"database-name:node id(ratio)"を指定できます。
    </para>
    <para>
     <!--
     Also you can specify list of "application-name:node id(ratio)" pairs to
     send SELECT queries to a particular backend node for a particular client
     application connection at a specified load balance ratio.
     -->
     特定のアプリケーション接続およびバックエンドノードに対して、指定した負荷分散の比でSELECTクエリを送るためのリスト"application-name:node id(ratio)"を指定できます。
    </para>
    <para>
     <!--
     This load balance ratio specifies a value between 0 and 1,
     and the default is 1.0.
     -->
     この負荷分散の比は 0から1の間の値を指定できます。
     デフォルトは1.0です。
    </para>
   </listitem>

   <listitem>
    <!--
    2018-06-14 [83906d1]
    -->
    <para>
     <!--
     Add new parameter <xref linkend="guc-primary-routing-query-pattern-list"> to enable
     specifying SQL patterns lists that should not be load-balanced. (Bo Peng)
     -->
     負荷分散すべきではないSQLパターンのリストを指定できる<xref linkend="guc-primary-routing-query-pattern-list"> を追加しました。(Bo Peng)
    </para>
    <para>
     <!--
     Specify a semicolon separated list of SQL patterns that
     should be sent to primary node only. Regular expression can be
     used in SQL patterns. Only Maste Slave mode is supported.
     -->
     プライマリノードだけに送るSQLのパターンをセミコロンで区切られたリストで指定できます。
     SQLのパターンには正規表現を使用することができます。
     この機能はマスタースレーブモードのみサポートします。
    </para>
   </listitem>

   <listitem>
    <!--
    2018-07-27 [54503f4]
    2018-08-02 [dac5573]
    2018-08-01 [8745853]
    -->
    <para>
     <!--
     Add new parameter <xref linkend="guc-log-client-messages"> to allow logging client message. (Takuma Hoshiai, Tatsuo Ishii)
     -->
     クライアントのメッセージに関するログ出力を許可する<xref linkend="guc-log-client-messages">を追加しました。(Takuma Hoshiai, Tatsuo Ishii)
    </para>
    <para>
     <!--
     Set <varname>log_client_messages = on</varname>, any client messages will be logged without debugging messages.
     -->
     <varname>log_client_messages = on</varname>を設定すると, デバックメッセージなしでクライアントのメッセージをログ出力できます。
    </para>
   </listitem>
   <listitem>
    <!--
    2018-06-12 [0312dc5]
    -->
    <para>
     <!--
     Add <literal>last_status_change</literal> column to <xref linkend="SQL-SHOW-POOL-NODES"> command. (Tatsuo Ishii)
     -->
     <xref linkend="SQL-SHOW-POOL-NODES">コマンドに<literal>last_status_change</literal>列を追加しました。
    </para>
    <para>
     <!--
     The new column indicates the time when <literal>status</literal> or <literal>role</literal> has been changed.
     -->
     新しい列は<literal>status</literal>もしくは<literal>role</literal>が変更された時刻を示します。
    </para>
    <para>
     <!--
     See <ulink url="http://www.sraoss.jp/pipermail/pgpool-hackers/2018-June/002822.html">
     [pgpool-hackers: 2822]</ulink> for the reasoning to add the column.
     -->
     列を追加した理由に関しては<ulink url="http://www.sraoss.jp/pipermail/pgpool-hackers/2018-June/002822.html">[pgpool-hackers: 2822]</ulink>を参照してください。
    </para>
   </listitem>
   <listitem>
    <!--
    2018-08-28 [8b43ac3]
    -->
    <para>
     <!--
     Import <productname>PostgreSQL</productname> 11's SQL  parser. (Bo Peng)
     -->
     <productname>PostgreSQL</productname>11のSQLパーサを取り込みました。(Bo Peng)
    </para>
    <para>
     <!--
     Now <productname>Pgpool-II</productname> can fully understand the newly added SQL syntax
     in <productname>PostgreSQL</productname> 11,
     such as <literal>CREATE/ALTER/DROP PROCEDURE</literal>,
     <literal>{ RANGE | ROWS | GROUPS } frame_start [ frame_exclusion ]</literal>, etc.
     -->
     <productname>Pgpool-II</productname>は<productname>PostgreSQL</productname>11で新しく追加されたSQLの構文を完全に理解できます。
     たとえば、<literal>CREATE/ALTER/DROP PROCEDURE</literal>や<literal>{ RANGE | ROWS | GROUPS } frame_start [ frame_exclusion ]</literal>などです。
    </para>
   </listitem>
  </itemizedlist>
 </sect2>

 <sect2>
  <!--
  <title>Other Enhancements</title>
  -->
  <title>他の改善点</title>
  <itemizedlist>
   <listitem>
    <!--
    2018-05-09 [719fbaa]
    2018-05-10 [edd10f6]
    -->
    <para>
     <!--
     Add "-r" option to <command>pgpool_setup</command> to allow use of <application>pg_rewind</application>. (Tatsuo Ishii)
     -->
     <command>pgpool_setup</command>コマンドに<application>pg_rewind</application>を使用するための"-r"オプションを追加しました。(Tatsuo Ishii)
    </para>
    <para>
     <!--
     With this option, <command>pgpool_setup</command> creates <filename>basebackup.sh</filename> which tries
     <application>pg_rewind</application> first.  If it fails, falls back to rsync.
     -->
     <command>pgpool_setup</command>のオンラインリカバリスクリプト<filename>basebackup.sh</filename>では、最初に<application>pg_rewind</application>を試します。
     <application>pg_rewind</application>が失敗した場合、rsyncを使用します。
    </para>
    <para>
     <!--
     Also a new environment variable "USE_PG_REWIND" to <application>pgpool_setup</application> is added.
     This brings the same effect as "-r" option is specified.
     -->
     また、<application>pgpool_setup</application>に新しい環境変数"USE_PG_REWIND"を追加しました。
     これは"-r"オプションと同様の効果があります。
    </para>
   </listitem>

   <listitem>
    <!--
    2018-04-16 [3d63b8a]
    2018-04-15 [4867cf2]
    2018-04-18 [1c9a5dd]
    2018-05-05 [50b4d27]
    2018-04-26 [b3a361c]
    2018-04-18 [1c9a5dd]
    2018-04-18 [1c9a5dd]
    -->
    <para>
     <!--
     Add "-s" option to <application>pgpool_setup</application> to support for replication slot. (Tatsuo Ishii)
     -->
     <application>pgpool_setup</application>コマンドにレプリケーションスロットを使用するための"-s"オプションを追加しました。(Tatsuo Ishii)
    </para>
    <para>
     <!--
     This eliminates the problem when standby is promoted. When a standby
     is promoted, it changes the time line in PITR archive, which will stop
     other standby if any because of shared archive directory.
     -->
     これはスタンバイを昇格する際の問題を解消します。
     スタンバイが昇格するときPITRアーカイブ中にタイムラインが変更されるため、他のスタンバイとアーカイブディレクトリを共有している場合他のスタンバイが停止していました。
    </para>
    <para>
     <!--
     Also a new environment variable "USE_REPLICATION_SLOT" to <application>pgpool_setup</application> is added.
     This brings the same effect as "-s" option is specified.
     -->
     また、<application>pgpool_setup</application>に新しい環境変数"USE_REPLICATION_SLOT"を追加しました。
     これは"-s"オプションと同様の効果があります。
    </para>
    <para>
     <!--
     If "USE_REPLICATION_SLOT=true", in streaming replication mode,
     use replication slot instead of archive.
     -->
     "USE_REPLICATION_SLOT=true"の場合、ストリーミングレプリケーションでアーカイブの代わりにレプリケーションスロットを使用できます。
    </para>
    <para>
     <!--
     By setting USE_REPLICATION_SLOT environment variable,
     now <application>pgpool_setup</application> in all tests uses replication slots.
     This reduces disk space under <filename>src/test/regression</filename> from
     6.3GB to 5.1GB (1.2GB savings).
     -->
     USE_REPLICATION_SLOT 環境変数を設定することにより、現在全てのテスト内の<application>pgpool_setup</application>でレプリケーションスロットが使われています。
     これは<filename>src/test/regression</filename>配下のディスクスペースを6.3GBから5.1GB減らします（1.2GBの節約）。
    </para>
   </listitem>
   <listitem>
    <!--
    2018-08-17 [3b51aa7]
    -->
    <para>
     <!--
     Introduce <xref linkend="PGPROTO"> to <productname>Pgpool-II</productname>. (Takuma Hoshiai)
     -->
     <productname>Pgpool-II</productname>に<xref linkend="PGPROTO">を導入しました。(Takuma Hoshiai)
    </para>
    <para>
     <!--
     A new utility <xref linkend="PGPROTO"> is added to test <productname>PostgreSQL</productname>
     or any other servers that understand the frontend/backend protocol.
     -->
     新しく追加した<xref linkend="PGPROTO">コマンドは、<productname>PostgreSQL</productname>もしくはフロントエンド/バックエンドプロトコルを理解するその他のサーバをテストします。
    </para>
   </listitem>
   <listitem>
    <!--
    2018-07-09 [62bd296]
    -->
    <para>
     <!--
     Allow to display <productname>Pgpool-II</productname> child process id and
     <productname>PostgreSQL</productname> backend id in <xref linkend="PCP-PROC-INFO">. (Tatsuo Ishii)
     -->
     <xref linkend="PCP-PROC-INFO">内で<productname>Pgpool-II</productname>の子プロセスIDと<productname>PostgreSQL</productname>のバックエンドIDを表示できます。(Tatsuo Ishii)
    </para>
    <para>
     <!--
     Add &#045;&#045;all option to display all child processes and their available connection slots.
     -->
     全ての子プロセスと利用可能な接続スロットが表示される--all オプション追加しました。
    </para>
   </listitem>
   <listitem>
    <!--
    2018-07-03 [a8a666a]
    -->
    <para>
     <!--
     Add <literal>replication_delay</> and <literal>last_status_change</> to
     <xref linkend="PCP-NODE-INFO">. (Tatsuo Ishii)
     -->
     <xref linkend="PCP-NODE-INFO">に<literal>replication_delay</>と<literal>last_status_change</>を追加しました。(Tatsuo Ishii)
    </para>
   </listitem>
   <listitem>
    <!--
    2018-07-05 [c47ac16]
    -->
    <para>
     <!--
     Add <literal>role</>, <literal>replication_delay</> and <literal>last_status_change</> columns to pgpool_adm's
     <xref linkend="PGPOOL-ADM-PCP-NODE-INFO">. (Tatsuo Ishii)
     -->
     pgpool_admの<xref linkend="PGPOOL-ADM-PCP-NODE-INFO">に<literal>role</>、<literal>replication_delay</>、<literal>last_status_change</>列を追加しました。(Tatsuo Ishii)
    </para>
   </listitem>
  </itemizedlist>
 </sect2>

 <sect2>
  <!--
  <title>Changes</title>
  -->
  <title>変更点</title>
  <itemizedlist>
   <listitem>
    <!--
    2018-05-07 [05c9297]
    -->
    <para>
     <!--
     Downgrade most of DEBUG1 messages to DEBUG5. (Tatsuo Ishii)
     -->
     大半のDBUG1のメッセージをDEBUG5に変更しました。(Tatsuo Ishii)
    </para>
    <para>
     <!--
     This significantly reduces the size of pgpool log when pgpool starts
     with -d option (this is equivalent to setting <xref linkend="guc-client-min-messages"> to debug1).
     -->
     Pgpool-IIを"-d"オプションで起動した場合のpgpoolログのサイズを大きく減らします。
     （これは<xref linkend="guc-client-min-messages"> = debug1と同等です）。
    </para>
    <para>
     <!--
     Per discussion <ulink url="http://www.sraoss.jp/pipermail/pgpool-hackers/2018-May/002794.html">
     [pgpool-hackers: 2794]</ulink>.
     -->
     <ulink url="http://www.sraoss.jp/pipermail/pgpool-hackers/2018-May/002794.html">
      [pgpool-hackers: 2794]</ulink>の議論の結果です。

    </para>
   </listitem>
  </itemizedlist>
 </sect2>

 <sect2>
  <!--
  <title>Bug fixes</title>
  -->
  <title>不具合修正</title>
  <itemizedlist>
   <listitem>
    <!--
    2018-10-18 [0b059bd]
    -->
    <para>
     <!--
     Fix syntax error in native replication, when queries including time functions
     (<literal>now()</literal>, etc.) and <literal>IN (SELECT ...)</literal> 
     in </literal>WHERE</literal> clause. 
     (<ulink url="http://www.pgpool.net/mantisbt/view.php?id=433">bug 433</ulink>) (Bo Peng)
     -->
     ネイティブレプリケーションモードで、<literal>SQL</literal> に <function>now()</function> などの時刻関数を利用した場合、<literal>WHERE</literal> 句に<literal>IN (SELECT ...)</literal>を含むと構文エラーになる不具合を修正しました。
     (<ulink url="http://www.pgpool.net/mantisbt/view.php?id=433">bug 433</ulink>) (Bo Peng)
    </para>
   </listitem>

   <listitem>
    <!--
    2018-07-31 [0f45b8d]
    -->
    <para>
     <!--
     Fix compiler error if HAVE_ASPRINTF is not defined. (Tatsuo Ishii)
     -->
     HAVE_ASPRINTFが定義されていない場合のコンパイラのエラーを修正しました。(Tatsuo Ishii)
    </para>
   </listitem>

   <listitem>
    <!--
    2018-07-31 [24973c0]
    -->
    <para>
     <!--
     Fix <filename>configure.ac</> to remove generating <filename>src/sql/pgpool_adm/Makefile.in</>. (Tatsuo Ishii)
     -->
     生成される<filename>src/sql/pgpool_adm/Makefile.in</>を削除するため<filename>configure.ac</>を修正しました。(Tatsuo Ishii)
    </para>
   </listitem>

   <listitem>
    <!--
    2018-05-24 [d2b8efd]
    -->
    <para>
     <!--
     Fix pgpool main process segfault when <productname>PostgreSQL</productname> 9.5 is used. (Tatsuo Ishii)
     -->
     <productname>PostgreSQL</productname> 9.5を使っている場合、Pgpoolのメインプロセスがセグフォルトするのを修正しました。(Tatsuo Ishii)
    </para>
    <para>
     <!--
     pgpool_setup -n 3 (or greater) triggers the bug. While recovering node
     2, pgpool main process tried to retrieve version info from backend #2
     even if it's not running. This causes the sefault because connection
     was not established yet. The reason why <productname>PostgreSQL 9.6</productname>
     or later was not suffered from the bug was, <productname>PostgreSQL</productname>
     exited the loop as soon as the server version is higher than 9.5. To fix this,
     call to VALID_BACKEND macro was added.
     -->
     pgpool_setup -n 3（またはそれ以上）の場合にバグが発生します。
     ノード2のリカバリをしている間、バックエンド#2が稼働していない場合であってもバージョン情報を取得しようとしていました。
     これは接続がまだ確立されてないためセグフォルトを引き起こします。
     <productname>PostgreSQL 9.6</productname>以降で発生しない理由は、<productname>PostgreSQL</productname>のバージョンが9.5以降の場合すぐにループが終了していたためです。
     これを修正するため、VALID_BACKENDマクロを呼ぶ処理を追加しました。
    </para>
   </listitem>

   <listitem>
    <!--
    2018-05-04 [4621577]
    -->
    <para>
     <!--
     Add missing <xref linkend="guc-health-check-timeout"> in pgpool_setup. (Tatsuo Ishii)
     -->
     pgpool_setupに<xref linkend="guc-health-check-timeout">を追加しました。(Tatsuo Ishii)
    </para>
    <para>
     <!--
     Per node health_check_timeout was missing and this should had been
     there since the per node health check parameter support was added.
     -->
     ノード毎のhealth_check_timeoutが抜けていました。
     これはノード毎のヘルスチェックのパラメータをサポートした際に追加したはずでした。
    </para>
   </listitem>

   <listitem>
    <!--
    2018-07-11 [27a0056]
    -->
    <para>
     <!--
     Test: Try to reduce the chance of regression 006.memcache failure. (Tatsuo Ishii)
     -->
     Test: リグレッションテスト 006.memcacheが失敗する可能性を減らしました。(Tatsuo Ishii)
    </para>
    <para>
     <!--
     It seems the occasional failure of the test is caused by replication
     lag.  The script tries to read tables from standby but it returns a
     table not existing error. So insert pg_sleep() after creation of
     tables.
     -->
     不定期にテストが失敗するのはレプリケーションラグが原因だと思われます。
     スクリプトはスタンバイからテーブルの読み込みを試しますが、まだテーブルが存在しないためエラーが返ってきます。
     そのため、テーブルの作成後pg_sleep()を挿入します。
    </para>
   </listitem>

   <listitem>
    <!--
    2018-05-21 [1d3ab38]
    -->
    <para>
     <!--
     Test: Fix regression test 055.backend_all_down error. (Bo Peng)
     -->
     Test: リグレッションテスト 055.backend_all_downのエラーを修正しました。(Bo Peng)
    </para>
   </listitem>

   <listitem>
    <!--
    2018-05-04 [1903325]
    -->
    <para>
     <!--
     Doc: Enhance online recovery document. (Tatsuo Ishii)
     -->
     Doc: オンラインリカバリのドキュメントを改善しました。(Tatsuo Ishii)
    </para>
    <para>
     <!--
     Clarify that 2nd stage command is only required in native replication mode.
     -->
     2nd stage コマンドはネイティブレプリケーションモードのみで必要であることを明確にしました。
    </para>
   </listitem>

   <listitem>
    <!--
    2018-02-27 [4eabecb]
    -->
    <para>
     <!--
     Test: Add new regression test <filename>017.node_0_is_down</> for node 0 not being primary. (Tatsuo Ishii)
     -->
     Test: ノード0がプライマリではない場合を想定した新しいリグレッションテスト <filename>017.node_0_is_down</>を追加しました。(Tatsuo Ishii)
    </para>
   </listitem>
  </itemizedlist>
 </sect2>
</sect1>
